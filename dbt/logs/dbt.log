[0m19:47:51.122410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5175bdd9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5174b95090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5174b94fa0>]}


============================== 19:47:51.126187 | 1b49090d-bf2e-4861-9893-8aa536c44ba0 ==============================
[0m19:47:51.126187 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:47:51.129740 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': '/home/ethancao/ds3022-data-project-1/dbt', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'quiet': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt debug', 'log_path': '/home/ethancao/ds3022-data-project-1/dbt/logs', 'indirect_selection': 'eager', 'log_format': 'default', 'partial_parse': 'True', 'use_colors': 'True', 'target_path': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'introspect': 'True'}
[0m19:47:51.139632 [info ] [MainThread]: dbt version: 1.10.13
[0m19:47:51.140481 [info ] [MainThread]: python version: 3.10.12
[0m19:47:51.142595 [info ] [MainThread]: python path: /home/ethancao/ds3022-data-project-1/.venv/bin/python
[0m19:47:51.144775 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.35
[0m19:47:51.326920 [info ] [MainThread]: Using profiles dir at /home/ethancao/ds3022-data-project-1/dbt
[0m19:47:51.327988 [info ] [MainThread]: Using profiles.yml file at /home/ethancao/ds3022-data-project-1/dbt/profiles.yml
[0m19:47:51.328685 [info ] [MainThread]: Using dbt_project.yml file at /home/ethancao/ds3022-data-project-1/dbt/dbt_project.yml
[0m19:47:51.330718 [info ] [MainThread]: adapter type: duckdb
[0m19:47:51.331553 [info ] [MainThread]: adapter version: 1.9.6
[0m19:47:51.491243 [info ] [MainThread]: Configuration:
[0m19:47:51.491967 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:47:51.492586 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:47:51.493127 [info ] [MainThread]: Required dependencies:
[0m19:47:51.493689 [debug] [MainThread]: Executing "git --help"
[0m19:47:51.495926 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:47:51.496620 [debug] [MainThread]: STDERR: "b''"
[0m19:47:51.497028 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:47:51.498907 [info ] [MainThread]: Connection:
[0m19:47:51.501869 [info ] [MainThread]:   database: emissions
[0m19:47:51.502422 [info ] [MainThread]:   schema: main
[0m19:47:51.503313 [info ] [MainThread]:   path: /home/ethancao/ds3022-data-project-1/emissions.duckdb
[0m19:47:51.504029 [info ] [MainThread]:   config_options: None
[0m19:47:51.504799 [info ] [MainThread]:   extensions: None
[0m19:47:51.505524 [info ] [MainThread]:   settings: {}
[0m19:47:51.506267 [info ] [MainThread]:   external_root: .
[0m19:47:51.507010 [info ] [MainThread]:   use_credential_provider: None
[0m19:47:51.507792 [info ] [MainThread]:   attach: None
[0m19:47:51.508522 [info ] [MainThread]:   filesystems: None
[0m19:47:51.509168 [info ] [MainThread]:   remote: None
[0m19:47:51.509785 [info ] [MainThread]:   plugins: None
[0m19:47:51.510477 [info ] [MainThread]:   disable_transactions: False
[0m19:47:51.511390 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m19:47:51.624068 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m19:47:51.653020 [debug] [MainThread]: Using duckdb connection "debug"
[0m19:47:51.653855 [debug] [MainThread]: On debug: select 1 as id
[0m19:47:51.654376 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:47:51.741679 [debug] [MainThread]: SQL status: OK in 0.087 seconds
[0m19:47:51.743216 [debug] [MainThread]: On debug: Close
[0m19:47:51.743972 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:47:51.744722 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:47:51.746517 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.69588125, "process_in_blocks": "3896", "process_kernel_time": 0.14103, "process_mem_max_rss": "182544", "process_out_blocks": "24", "process_user_time": 2.196053}
[0m19:47:51.747514 [debug] [MainThread]: Command `dbt debug` succeeded at 19:47:51.747336 after 0.70 seconds
[0m19:47:51.748030 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:47:51.748683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5175bdd9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51759740d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5168e54e80>]}
[0m19:47:51.749456 [debug] [MainThread]: Flushing usage events
[0m19:47:51.906851 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:48:03.346238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ab395a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76aa34c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76aa34c250>]}


============================== 19:48:03.354281 | b7f40d1f-85fb-43a2-a9ba-685b744fcbd2 ==============================
[0m19:48:03.354281 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:48:03.355258 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'target_path': 'None', 'no_print': 'None', 'log_path': '/home/ethancao/ds3022-data-project-1/dbt/logs', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'invocation_command': 'dbt run', 'empty': 'False', 'printer_width': '80', 'quiet': 'False', 'version_check': 'True', 'introspect': 'True', 'profiles_dir': '/home/ethancao/ds3022-data-project-1/dbt', 'static_parser': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True'}
[0m19:48:03.702680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7f40d1f-85fb-43a2-a9ba-685b744fcbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769e7e6590>]}
[0m19:48:03.808402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7f40d1f-85fb-43a2-a9ba-685b744fcbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76aa2f9390>]}
[0m19:48:03.810585 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m19:48:03.934308 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:48:03.935139 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:48:03.935723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b7f40d1f-85fb-43a2-a9ba-685b744fcbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769e659e70>]}
[0m19:48:05.559555 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxi_co2.staging
[0m19:48:05.571879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7f40d1f-85fb-43a2-a9ba-685b744fcbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7686043ee0>]}
[0m19:48:05.698004 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m19:48:05.700074 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m19:48:05.714286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7f40d1f-85fb-43a2-a9ba-685b744fcbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76861b9120>]}
[0m19:48:05.715007 [info ] [MainThread]: Found 1 model, 3 sources, 431 macros
[0m19:48:05.715613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7f40d1f-85fb-43a2-a9ba-685b744fcbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7686041000>]}
[0m19:48:05.717736 [info ] [MainThread]: 
[0m19:48:05.718411 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:48:05.718963 [info ] [MainThread]: 
[0m19:48:05.719770 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:48:05.721086 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_emissions'
[0m19:48:05.766793 [debug] [ThreadPool]: Using duckdb connection "list_emissions"
[0m19:48:05.767643 [debug] [ThreadPool]: On list_emissions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"emissions"'
    
  
  
[0m19:48:05.768122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:05.814259 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m19:48:05.816116 [debug] [ThreadPool]: On list_emissions: Close
[0m19:48:05.817562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_emissions, now create_emissions_main)
[0m19:48:05.818430 [debug] [ThreadPool]: Creating schema "database: "emissions"
schema: "main"
"
[0m19:48:05.828244 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m19:48:05.828861 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='emissions'
        and type='sqlite'
    
  
[0m19:48:05.829321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:48:05.831218 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:48:05.833093 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m19:48:05.833634 [debug] [ThreadPool]: On create_emissions_main: BEGIN
[0m19:48:05.834774 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:48:05.835394 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m19:48:05.835873 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
    
        create schema if not exists "emissions"."main"
    
[0m19:48:05.837002 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:48:05.838382 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m19:48:05.838977 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m19:48:05.839502 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m19:48:05.840509 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:48:05.841053 [debug] [ThreadPool]: On create_emissions_main: Close
[0m19:48:05.842907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_emissions_main, now list_emissions_main)
[0m19:48:05.850690 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m19:48:05.851300 [debug] [ThreadPool]: On list_emissions_main: BEGIN
[0m19:48:05.851848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:48:05.853010 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:48:05.853551 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m19:48:05.854028 [debug] [ThreadPool]: On list_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions_main"} */
select
      'emissions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'emissions'
  
[0m19:48:05.869059 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m19:48:05.870794 [debug] [ThreadPool]: On list_emissions_main: ROLLBACK
[0m19:48:05.871566 [debug] [ThreadPool]: Failed to rollback 'list_emissions_main'
[0m19:48:05.872073 [debug] [ThreadPool]: On list_emissions_main: Close
[0m19:48:05.874074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7f40d1f-85fb-43a2-a9ba-685b744fcbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76854a36a0>]}
[0m19:48:05.874782 [debug] [MainThread]: Using duckdb connection "master"
[0m19:48:05.875221 [debug] [MainThread]: On master: BEGIN
[0m19:48:05.875595 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:48:05.876641 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:48:05.877193 [debug] [MainThread]: On master: COMMIT
[0m19:48:05.877741 [debug] [MainThread]: Using duckdb connection "master"
[0m19:48:05.878206 [debug] [MainThread]: On master: COMMIT
[0m19:48:05.879169 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:48:05.879707 [debug] [MainThread]: On master: Close
[0m19:48:05.905629 [debug] [Thread-1 (]: Began running node model.taxi_co2.transform
[0m19:48:05.907110 [info ] [Thread-1 (]: 1 of 1 START sql view model main.transform ..................................... [RUN]
[0m19:48:05.908491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_emissions_main, now model.taxi_co2.transform)
[0m19:48:05.909465 [debug] [Thread-1 (]: Began compiling node model.taxi_co2.transform
[0m19:48:05.930260 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_co2.transform"
[0m19:48:05.932639 [debug] [Thread-1 (]: Began executing node model.taxi_co2.transform
[0m19:48:06.003059 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_co2.transform"
[0m19:48:06.004693 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m19:48:06.005417 [debug] [Thread-1 (]: On model.taxi_co2.transform: BEGIN
[0m19:48:06.006267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:48:06.009297 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:48:06.009918 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m19:48:06.010493 [debug] [Thread-1 (]: On model.taxi_co2.transform: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

  
  create view "emissions"."main"."transform__dbt_tmp" as (
    { { config(materialized = 'table',) } } -- yellow taxi transformation
ALTER TABLE yellow_taxi
ADD COLUMN IF NOT EXISTS CO2_PER_TRIP_KGS BIGINT;
ALTER TABLE yellow_taxi
ADD COLUMN IF NOT EXISTS AVG_MPH_PER_TRIP FLOAT;
ALTER TABLE yellow_taxi
ADD COLUMN IF NOT EXISTS TRIP_HOURS FLOAT;
ALTER TABLE yellow_taxi
ADD COLUMN IF NOT EXISTS TRIP_DAY_OF_WEEK INT;
ALTER TABLE yellow_taxi
ADD COLUMN IF NOT EXISTS WEEK_NUMBER INT;
ALTER TABLE yellow_taxi
ADD COLUMN IF NOT EXISTS MONTH INT;
  );

[0m19:48:06.011468 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

  
  create view "emissions"."main"."transform__dbt_tmp" as (
    { { config(materialized = 'table',) } } -- yellow taxi transformation
ALTER TABLE yellow_taxi
ADD COLUMN IF NOT EXISTS CO2_PER_TRIP_KGS BIGINT;
ALTER TABLE yellow_taxi
ADD COLUMN IF NOT EXISTS AVG_MPH_PER_TRIP FLOAT;
ALTER TABLE yellow_taxi
ADD COLUMN IF NOT EXISTS TRIP_HOURS FLOAT;
ALTER TABLE yellow_taxi
ADD COLUMN IF NOT EXISTS TRIP_DAY_OF_WEEK INT;
ALTER TABLE yellow_taxi
ADD COLUMN IF NOT EXISTS WEEK_NUMBER INT;
ALTER TABLE yellow_taxi
ADD COLUMN IF NOT EXISTS MONTH INT;
  );

[0m19:48:06.012135 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m19:48:06.014284 [debug] [Thread-1 (]: On model.taxi_co2.transform: ROLLBACK
[0m19:48:06.035767 [debug] [Thread-1 (]: Failed to rollback 'model.taxi_co2.transform'
[0m19:48:06.036541 [debug] [Thread-1 (]: On model.taxi_co2.transform: Close
[0m19:48:06.038319 [debug] [Thread-1 (]: Runtime Error in model transform (models/transform.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'table',) } } -- yellow taxi tran...
              ^
[0m19:48:06.041665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7f40d1f-85fb-43a2-a9ba-685b744fcbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f768547ce20>]}
[0m19:48:06.042794 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.transform ............................ [[31mERROR[0m in 0.13s]
[0m19:48:06.043884 [debug] [Thread-1 (]: Finished running node model.taxi_co2.transform
[0m19:48:06.044939 [debug] [Thread-7 (]: Marking all children of 'model.taxi_co2.transform' to be skipped because of status 'error'.  Reason: Runtime Error in model transform (models/transform.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'table',) } } -- yellow taxi tran...
              ^.
[0m19:48:06.047751 [debug] [MainThread]: Using duckdb connection "master"
[0m19:48:06.048282 [debug] [MainThread]: On master: BEGIN
[0m19:48:06.048860 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:48:06.050247 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:48:06.050859 [debug] [MainThread]: On master: COMMIT
[0m19:48:06.051502 [debug] [MainThread]: Using duckdb connection "master"
[0m19:48:06.052034 [debug] [MainThread]: On master: COMMIT
[0m19:48:06.053060 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:48:06.053612 [debug] [MainThread]: On master: Close
[0m19:48:06.054367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:48:06.054837 [debug] [MainThread]: Connection 'model.taxi_co2.transform' was properly closed.
[0m19:48:06.055390 [info ] [MainThread]: 
[0m19:48:06.055994 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m19:48:06.057032 [debug] [MainThread]: Command end result
[0m19:48:06.205451 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m19:48:06.208257 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m19:48:06.225000 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/ethancao/ds3022-data-project-1/dbt/target/run_results.json
[0m19:48:06.225663 [info ] [MainThread]: 
[0m19:48:06.226385 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:48:06.226994 [info ] [MainThread]: 
[0m19:48:06.227689 [error] [MainThread]: [31mFailure in model transform (models/transform.sql)[0m
[0m19:48:06.228347 [error] [MainThread]:   Runtime Error in model transform (models/transform.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'table',) } } -- yellow taxi tran...
              ^
[0m19:48:06.228807 [info ] [MainThread]: 
[0m19:48:06.229349 [info ] [MainThread]:   compiled code at target/compiled/taxi_co2/models/transform.sql
[0m19:48:06.229771 [info ] [MainThread]: 
[0m19:48:06.230261 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:48:06.231582 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.9669049, "process_in_blocks": "144", "process_kernel_time": 0.229888, "process_mem_max_rss": "212060", "process_out_blocks": "2664", "process_user_time": 4.357892}
[0m19:48:06.232293 [debug] [MainThread]: Command `dbt run` failed at 19:48:06.232121 after 2.97 seconds
[0m19:48:06.233061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76854a2aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76854a2a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76854a2f50>]}
[0m19:48:06.234134 [debug] [MainThread]: Flushing usage events
[0m19:48:06.378948 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:48:56.350449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafeb379a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafea335210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafea3351b0>]}


============================== 19:48:56.353851 | 59a587bf-df81-4cc7-b053-1d04d46767ea ==============================
[0m19:48:56.353851 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:48:56.354781 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'empty': 'False', 'log_path': '/home/ethancao/ds3022-data-project-1/dbt/logs', 'write_json': 'True', 'version_check': 'True', 'warn_error': 'None', 'static_parser': 'True', 'quiet': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'profiles_dir': '/home/ethancao/ds3022-data-project-1/dbt', 'target_path': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m19:48:56.711843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59a587bf-df81-4cc7-b053-1d04d46767ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafde7e2590>]}
[0m19:48:56.795693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59a587bf-df81-4cc7-b053-1d04d46767ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafea2e0670>]}
[0m19:48:56.797890 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m19:48:56.951953 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:48:57.109084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:48:57.115084 [debug] [MainThread]: Partial parsing: updated file: taxi_co2://models/transform.sql
[0m19:48:57.530920 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxi_co2.staging
[0m19:48:57.558940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59a587bf-df81-4cc7-b053-1d04d46767ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafec91f9d0>]}
[0m19:48:57.678054 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m19:48:57.680124 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m19:48:57.698346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59a587bf-df81-4cc7-b053-1d04d46767ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafdc3e6350>]}
[0m19:48:57.699230 [info ] [MainThread]: Found 1 model, 3 sources, 431 macros
[0m19:48:57.700072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59a587bf-df81-4cc7-b053-1d04d46767ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafdc3e4130>]}
[0m19:48:57.702265 [info ] [MainThread]: 
[0m19:48:57.703629 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:48:57.704289 [info ] [MainThread]: 
[0m19:48:57.705449 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:48:57.707063 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_emissions'
[0m19:48:57.760435 [debug] [ThreadPool]: Using duckdb connection "list_emissions"
[0m19:48:57.761902 [debug] [ThreadPool]: On list_emissions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"emissions"'
    
  
  
[0m19:48:57.762782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:57.807671 [debug] [ThreadPool]: SQL status: OK in 0.045 seconds
[0m19:48:57.812842 [debug] [ThreadPool]: On list_emissions: Close
[0m19:48:57.814227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_emissions, now create_emissions_main)
[0m19:48:57.815097 [debug] [ThreadPool]: Creating schema "database: "emissions"
schema: "main"
"
[0m19:48:57.823770 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m19:48:57.824360 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='emissions'
        and type='sqlite'
    
  
[0m19:48:57.824862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:48:57.826836 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:48:57.828426 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m19:48:57.828926 [debug] [ThreadPool]: On create_emissions_main: BEGIN
[0m19:48:57.832885 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:48:57.833564 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m19:48:57.834220 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
    
        create schema if not exists "emissions"."main"
    
[0m19:48:57.836374 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:48:57.840899 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m19:48:57.841758 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m19:48:57.842504 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m19:48:57.843806 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:48:57.844603 [debug] [ThreadPool]: On create_emissions_main: Close
[0m19:48:57.846901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_emissions_main, now list_emissions_main)
[0m19:48:57.857145 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m19:48:57.859655 [debug] [ThreadPool]: On list_emissions_main: BEGIN
[0m19:48:57.860286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:48:57.863390 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m19:48:57.863923 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m19:48:57.864440 [debug] [ThreadPool]: On list_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions_main"} */
select
      'emissions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'emissions'
  
[0m19:48:57.881992 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m19:48:57.885005 [debug] [ThreadPool]: On list_emissions_main: ROLLBACK
[0m19:48:57.886035 [debug] [ThreadPool]: Failed to rollback 'list_emissions_main'
[0m19:48:57.886689 [debug] [ThreadPool]: On list_emissions_main: Close
[0m19:48:57.889419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59a587bf-df81-4cc7-b053-1d04d46767ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafdc4978b0>]}
[0m19:48:57.890405 [debug] [MainThread]: Using duckdb connection "master"
[0m19:48:57.891079 [debug] [MainThread]: On master: BEGIN
[0m19:48:57.891714 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:48:57.893098 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:48:57.893956 [debug] [MainThread]: On master: COMMIT
[0m19:48:57.894514 [debug] [MainThread]: Using duckdb connection "master"
[0m19:48:57.895296 [debug] [MainThread]: On master: COMMIT
[0m19:48:57.897653 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:48:57.898278 [debug] [MainThread]: On master: Close
[0m19:48:57.905218 [debug] [Thread-1 (]: Began running node model.taxi_co2.transform
[0m19:48:57.906332 [info ] [Thread-1 (]: 1 of 1 START sql view model main.transform ..................................... [RUN]
[0m19:48:57.907184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_emissions_main, now model.taxi_co2.transform)
[0m19:48:57.907902 [debug] [Thread-1 (]: Began compiling node model.taxi_co2.transform
[0m19:48:57.921710 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_co2.transform"
[0m19:48:57.922944 [debug] [Thread-1 (]: Began executing node model.taxi_co2.transform
[0m19:48:57.985818 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_co2.transform"
[0m19:48:57.987651 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m19:48:57.988389 [debug] [Thread-1 (]: On model.taxi_co2.transform: BEGIN
[0m19:48:57.989087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:48:57.990579 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:48:57.991633 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m19:48:57.992290 [debug] [Thread-1 (]: On model.taxi_co2.transform: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

  
  create view "emissions"."main"."transform__dbt_tmp" as (
    { { config(materialized = 'table') } } -- yellow taxi transformations
-- add CO2_PER_TRIP_KGS column
ALTER TABLE yellow_taxi
ADD COLUMN IF NOT EXISTS co2_per_trip_kgs DOUBLE;
UPDATE yellow_taxi y
SET co2_per_trip_kgs = (y.trip_distance * v.co2_grams_per_mile) / 1000.0
FROM vehicle_emissions v
WHERE v.vehicle_type = 'yellow_taxi';
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS AVG_MPH_PER_TRIP FLOAT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS TRIP_HOURS FLOAT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS TRIP_DAY_OF_WEEK INT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS WEEK_NUMBER INT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS MONTH_NUMBER INT;
  );

[0m19:48:57.993266 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

  
  create view "emissions"."main"."transform__dbt_tmp" as (
    { { config(materialized = 'table') } } -- yellow taxi transformations
-- add CO2_PER_TRIP_KGS column
ALTER TABLE yellow_taxi
ADD COLUMN IF NOT EXISTS co2_per_trip_kgs DOUBLE;
UPDATE yellow_taxi y
SET co2_per_trip_kgs = (y.trip_distance * v.co2_grams_per_mile) / 1000.0
FROM vehicle_emissions v
WHERE v.vehicle_type = 'yellow_taxi';
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS AVG_MPH_PER_TRIP FLOAT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS TRIP_HOURS FLOAT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS TRIP_DAY_OF_WEEK INT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS WEEK_NUMBER INT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS MONTH_NUMBER INT;
  );

[0m19:48:57.993917 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m19:48:57.994674 [debug] [Thread-1 (]: On model.taxi_co2.transform: ROLLBACK
[0m19:48:57.997030 [debug] [Thread-1 (]: Failed to rollback 'model.taxi_co2.transform'
[0m19:48:57.997658 [debug] [Thread-1 (]: On model.taxi_co2.transform: Close
[0m19:48:57.999079 [debug] [Thread-1 (]: Runtime Error in model transform (models/transform.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'table') } } -- yellow taxi trans...
              ^
[0m19:48:58.001315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59a587bf-df81-4cc7-b053-1d04d46767ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafea337070>]}
[0m19:48:58.002318 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.transform ............................ [[31mERROR[0m in 0.09s]
[0m19:48:58.003379 [debug] [Thread-1 (]: Finished running node model.taxi_co2.transform
[0m19:48:58.004216 [debug] [Thread-7 (]: Marking all children of 'model.taxi_co2.transform' to be skipped because of status 'error'.  Reason: Runtime Error in model transform (models/transform.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'table') } } -- yellow taxi trans...
              ^.
[0m19:48:58.006790 [debug] [MainThread]: Using duckdb connection "master"
[0m19:48:58.007371 [debug] [MainThread]: On master: BEGIN
[0m19:48:58.007872 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:48:58.009309 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:48:58.009966 [debug] [MainThread]: On master: COMMIT
[0m19:48:58.010675 [debug] [MainThread]: Using duckdb connection "master"
[0m19:48:58.011321 [debug] [MainThread]: On master: COMMIT
[0m19:48:58.012643 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:48:58.013391 [debug] [MainThread]: On master: Close
[0m19:48:58.014301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:48:58.014796 [debug] [MainThread]: Connection 'model.taxi_co2.transform' was properly closed.
[0m19:48:58.015429 [info ] [MainThread]: 
[0m19:48:58.026750 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m19:48:58.028619 [debug] [MainThread]: Command end result
[0m19:48:58.080982 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m19:48:58.083552 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m19:48:58.093556 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/ethancao/ds3022-data-project-1/dbt/target/run_results.json
[0m19:48:58.094316 [info ] [MainThread]: 
[0m19:48:58.095352 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:48:58.095941 [info ] [MainThread]: 
[0m19:48:58.096498 [error] [MainThread]: [31mFailure in model transform (models/transform.sql)[0m
[0m19:48:58.097017 [error] [MainThread]:   Runtime Error in model transform (models/transform.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'table') } } -- yellow taxi trans...
              ^
[0m19:48:58.097463 [info ] [MainThread]: 
[0m19:48:58.097941 [info ] [MainThread]:   compiled code at target/compiled/taxi_co2/models/transform.sql
[0m19:48:58.098335 [info ] [MainThread]: 
[0m19:48:58.098769 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:48:58.099848 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8257972, "process_in_blocks": "0", "process_kernel_time": 0.160353, "process_mem_max_rss": "206960", "process_out_blocks": "2680", "process_user_time": 3.387464}
[0m19:48:58.100572 [debug] [MainThread]: Command `dbt run` failed at 19:48:58.100436 after 1.83 seconds
[0m19:48:58.101096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafeb379a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafde7e2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafea2931f0>]}
[0m19:48:58.101639 [debug] [MainThread]: Flushing usage events
[0m19:48:58.263275 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:50:33.632094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73831b19c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73821411b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7382141150>]}


============================== 19:50:33.635521 | d26a2ea6-1895-423e-99af-0b1233297fb5 ==============================
[0m19:50:33.635521 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:50:33.636398 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': '/home/ethancao/ds3022-data-project-1/dbt/logs', 'static_parser': 'True', 'printer_width': '80', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '/home/ethancao/ds3022-data-project-1/dbt', 'no_print': 'None', 'write_json': 'True', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'use_colors': 'True'}
[0m19:50:33.987017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd26a2ea6-1895-423e-99af-0b1233297fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73765ba530>]}
[0m19:50:34.093111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd26a2ea6-1895-423e-99af-0b1233297fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738299ba60>]}
[0m19:50:34.095310 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m19:50:34.215760 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:50:34.379389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:50:34.380035 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:50:34.388835 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxi_co2.staging
[0m19:50:34.450414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd26a2ea6-1895-423e-99af-0b1233297fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7374288130>]}
[0m19:50:34.569861 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m19:50:34.572176 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m19:50:34.585160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd26a2ea6-1895-423e-99af-0b1233297fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73742bdf00>]}
[0m19:50:34.586150 [info ] [MainThread]: Found 1 model, 3 sources, 431 macros
[0m19:50:34.586927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd26a2ea6-1895-423e-99af-0b1233297fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73742bd420>]}
[0m19:50:34.588963 [info ] [MainThread]: 
[0m19:50:34.589619 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:50:34.590186 [info ] [MainThread]: 
[0m19:50:34.591004 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:50:34.593586 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_emissions'
[0m19:50:34.701647 [debug] [ThreadPool]: Using duckdb connection "list_emissions"
[0m19:50:34.702311 [debug] [ThreadPool]: On list_emissions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"emissions"'
    
  
  
[0m19:50:34.702956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:34.760558 [debug] [ThreadPool]: SQL status: OK in 0.058 seconds
[0m19:50:34.762546 [debug] [ThreadPool]: On list_emissions: Close
[0m19:50:34.763756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_emissions, now create_emissions_main)
[0m19:50:34.764485 [debug] [ThreadPool]: Creating schema "database: "emissions"
schema: "main"
"
[0m19:50:34.776049 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m19:50:34.776670 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='emissions'
        and type='sqlite'
    
  
[0m19:50:34.777353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:34.779244 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:50:34.780815 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m19:50:34.781371 [debug] [ThreadPool]: On create_emissions_main: BEGIN
[0m19:50:34.782461 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:50:34.783060 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m19:50:34.784405 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
    
        create schema if not exists "emissions"."main"
    
[0m19:50:34.785633 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:50:34.787313 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m19:50:34.788031 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m19:50:34.788582 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m19:50:34.789503 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:50:34.789998 [debug] [ThreadPool]: On create_emissions_main: Close
[0m19:50:34.791672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_emissions_main, now list_emissions_main)
[0m19:50:34.798496 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m19:50:34.799121 [debug] [ThreadPool]: On list_emissions_main: BEGIN
[0m19:50:34.799848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:34.801079 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:50:34.801593 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m19:50:34.802072 [debug] [ThreadPool]: On list_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions_main"} */
select
      'emissions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'emissions'
  
[0m19:50:34.816286 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m19:50:34.818115 [debug] [ThreadPool]: On list_emissions_main: ROLLBACK
[0m19:50:34.818828 [debug] [ThreadPool]: Failed to rollback 'list_emissions_main'
[0m19:50:34.819284 [debug] [ThreadPool]: On list_emissions_main: Close
[0m19:50:34.820992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd26a2ea6-1895-423e-99af-0b1233297fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73742d5900>]}
[0m19:50:34.821659 [debug] [MainThread]: Using duckdb connection "master"
[0m19:50:34.822108 [debug] [MainThread]: On master: BEGIN
[0m19:50:34.822525 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:50:34.823877 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:50:34.824360 [debug] [MainThread]: On master: COMMIT
[0m19:50:34.824841 [debug] [MainThread]: Using duckdb connection "master"
[0m19:50:34.825372 [debug] [MainThread]: On master: COMMIT
[0m19:50:34.826311 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:50:34.826806 [debug] [MainThread]: On master: Close
[0m19:50:34.831312 [debug] [Thread-1 (]: Began running node model.taxi_co2.transform
[0m19:50:34.832673 [info ] [Thread-1 (]: 1 of 1 START sql view model main.transform ..................................... [RUN]
[0m19:50:34.833707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_emissions_main, now model.taxi_co2.transform)
[0m19:50:34.834457 [debug] [Thread-1 (]: Began compiling node model.taxi_co2.transform
[0m19:50:34.859786 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_co2.transform"
[0m19:50:34.865316 [debug] [Thread-1 (]: Began executing node model.taxi_co2.transform
[0m19:50:34.917592 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_co2.transform"
[0m19:50:34.919029 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m19:50:34.919683 [debug] [Thread-1 (]: On model.taxi_co2.transform: BEGIN
[0m19:50:34.920278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:34.921706 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:50:34.922295 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m19:50:34.922892 [debug] [Thread-1 (]: On model.taxi_co2.transform: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

  
  create view "emissions"."main"."transform__dbt_tmp" as (
    { { config(materialized = 'table') } } -- yellow taxi transformations
-- add CO2_PER_TRIP_KGS column
ALTER TABLE yellow_taxi
ADD COLUMN IF NOT EXISTS co2_per_trip_kgs DOUBLE;
UPDATE yellow_taxi y
SET co2_per_trip_kgs = (y.trip_distance * v.co2_grams_per_mile) / 1000.0
FROM vehicle_emissions v
WHERE v.vehicle_type = 'yellow_taxi';
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS AVG_MPH_PER_TRIP FLOAT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS TRIP_HOURS FLOAT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS TRIP_DAY_OF_WEEK INT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS WEEK_NUMBER INT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS MONTH_NUMBER INT;
  );

[0m19:50:34.923884 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

  
  create view "emissions"."main"."transform__dbt_tmp" as (
    { { config(materialized = 'table') } } -- yellow taxi transformations
-- add CO2_PER_TRIP_KGS column
ALTER TABLE yellow_taxi
ADD COLUMN IF NOT EXISTS co2_per_trip_kgs DOUBLE;
UPDATE yellow_taxi y
SET co2_per_trip_kgs = (y.trip_distance * v.co2_grams_per_mile) / 1000.0
FROM vehicle_emissions v
WHERE v.vehicle_type = 'yellow_taxi';
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS AVG_MPH_PER_TRIP FLOAT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS TRIP_HOURS FLOAT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS TRIP_DAY_OF_WEEK INT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS WEEK_NUMBER INT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS MONTH_NUMBER INT;
  );

[0m19:50:34.924691 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m19:50:34.925384 [debug] [Thread-1 (]: On model.taxi_co2.transform: ROLLBACK
[0m19:50:34.927829 [debug] [Thread-1 (]: Failed to rollback 'model.taxi_co2.transform'
[0m19:50:34.928380 [debug] [Thread-1 (]: On model.taxi_co2.transform: Close
[0m19:50:34.929869 [debug] [Thread-1 (]: Runtime Error in model transform (models/transform.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'table') } } -- yellow taxi trans...
              ^
[0m19:50:34.931949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd26a2ea6-1895-423e-99af-0b1233297fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7382143010>]}
[0m19:50:34.932956 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.transform ............................ [[31mERROR[0m in 0.10s]
[0m19:50:34.933922 [debug] [Thread-1 (]: Finished running node model.taxi_co2.transform
[0m19:50:34.934741 [debug] [Thread-7 (]: Marking all children of 'model.taxi_co2.transform' to be skipped because of status 'error'.  Reason: Runtime Error in model transform (models/transform.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'table') } } -- yellow taxi trans...
              ^.
[0m19:50:34.937419 [debug] [MainThread]: Using duckdb connection "master"
[0m19:50:34.937942 [debug] [MainThread]: On master: BEGIN
[0m19:50:34.938408 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:50:34.939739 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:50:34.940487 [debug] [MainThread]: On master: COMMIT
[0m19:50:34.941133 [debug] [MainThread]: Using duckdb connection "master"
[0m19:50:34.941735 [debug] [MainThread]: On master: COMMIT
[0m19:50:34.942881 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:50:34.943567 [debug] [MainThread]: On master: Close
[0m19:50:34.944537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:34.945136 [debug] [MainThread]: Connection 'model.taxi_co2.transform' was properly closed.
[0m19:50:34.946282 [info ] [MainThread]: 
[0m19:50:34.947796 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m19:50:34.949821 [debug] [MainThread]: Command end result
[0m19:50:35.006477 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m19:50:35.009104 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m19:50:35.018101 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/ethancao/ds3022-data-project-1/dbt/target/run_results.json
[0m19:50:35.018667 [info ] [MainThread]: 
[0m19:50:35.019467 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:50:35.020151 [info ] [MainThread]: 
[0m19:50:35.020822 [error] [MainThread]: [31mFailure in model transform (models/transform.sql)[0m
[0m19:50:35.021325 [error] [MainThread]:   Runtime Error in model transform (models/transform.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'table') } } -- yellow taxi trans...
              ^
[0m19:50:35.021756 [info ] [MainThread]: 
[0m19:50:35.022225 [info ] [MainThread]:   compiled code at target/compiled/taxi_co2/models/transform.sql
[0m19:50:35.022616 [info ] [MainThread]: 
[0m19:50:35.023877 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:50:35.025353 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4637433, "process_in_blocks": "0", "process_kernel_time": 0.279952, "process_mem_max_rss": "199360", "process_out_blocks": "1808", "process_user_time": 2.86951}
[0m19:50:35.026259 [debug] [MainThread]: Command `dbt run` failed at 19:50:35.026050 after 1.46 seconds
[0m19:50:35.026991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73831b19c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73765b8ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738308f790>]}
[0m19:50:35.027780 [debug] [MainThread]: Flushing usage events
[0m19:50:35.226128 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:55:12.636666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22be9559f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bd8fd1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bd8fd180>]}


============================== 19:55:12.641166 | dbcfa0ad-620f-4465-bddf-944846c1d041 ==============================
[0m19:55:12.641166 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:55:12.642074 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'use_colors': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'write_json': 'True', 'fail_fast': 'False', 'debug': 'False', 'quiet': 'False', 'no_print': 'None', 'static_parser': 'True', 'log_format': 'default', 'profiles_dir': '/home/ethancao/ds3022-data-project-1/dbt', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_path': '/home/ethancao/ds3022-data-project-1/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:55:12.969113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbcfa0ad-620f-4465-bddf-944846c1d041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bd81ec50>]}
[0m19:55:13.073020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbcfa0ad-620f-4465-bddf-944846c1d041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bdb16200>]}
[0m19:55:13.075212 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m19:55:13.159124 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:55:13.313137 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:55:13.313724 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:55:13.321500 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxi_co2.staging
[0m19:55:13.378599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbcfa0ad-620f-4465-bddf-944846c1d041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b1984130>]}
[0m19:55:13.504944 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m19:55:13.506942 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m19:55:13.522769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbcfa0ad-620f-4465-bddf-944846c1d041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b19262f0>]}
[0m19:55:13.523573 [info ] [MainThread]: Found 1 model, 3 sources, 431 macros
[0m19:55:13.524296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbcfa0ad-620f-4465-bddf-944846c1d041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22be6ed240>]}
[0m19:55:13.526202 [info ] [MainThread]: 
[0m19:55:13.526878 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:55:13.527480 [info ] [MainThread]: 
[0m19:55:13.528333 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:55:13.529792 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_emissions'
[0m19:55:13.637120 [debug] [ThreadPool]: Using duckdb connection "list_emissions"
[0m19:55:13.637877 [debug] [ThreadPool]: On list_emissions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"emissions"'
    
  
  
[0m19:55:13.638413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:13.690945 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m19:55:13.692675 [debug] [ThreadPool]: On list_emissions: Close
[0m19:55:13.693959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_emissions, now create_emissions_main)
[0m19:55:13.694684 [debug] [ThreadPool]: Creating schema "database: "emissions"
schema: "main"
"
[0m19:55:13.708010 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m19:55:13.708732 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='emissions'
        and type='sqlite'
    
  
[0m19:55:13.709319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:55:13.711064 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:55:13.712672 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m19:55:13.713181 [debug] [ThreadPool]: On create_emissions_main: BEGIN
[0m19:55:13.714246 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:55:13.714746 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m19:55:13.715189 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
    
        create schema if not exists "emissions"."main"
    
[0m19:55:13.716180 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:55:13.717179 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m19:55:13.717899 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m19:55:13.718505 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m19:55:13.719649 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:55:13.720331 [debug] [ThreadPool]: On create_emissions_main: Close
[0m19:55:13.722563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_emissions_main, now list_emissions_main)
[0m19:55:13.729274 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m19:55:13.729807 [debug] [ThreadPool]: On list_emissions_main: BEGIN
[0m19:55:13.730287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:55:13.732752 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:55:13.733516 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m19:55:13.733995 [debug] [ThreadPool]: On list_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions_main"} */
select
      'emissions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'emissions'
  
[0m19:55:13.746524 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m19:55:13.748252 [debug] [ThreadPool]: On list_emissions_main: ROLLBACK
[0m19:55:13.749006 [debug] [ThreadPool]: Failed to rollback 'list_emissions_main'
[0m19:55:13.750332 [debug] [ThreadPool]: On list_emissions_main: Close
[0m19:55:13.752024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbcfa0ad-620f-4465-bddf-944846c1d041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b1925b70>]}
[0m19:55:13.752739 [debug] [MainThread]: Using duckdb connection "master"
[0m19:55:13.753203 [debug] [MainThread]: On master: BEGIN
[0m19:55:13.753715 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:55:13.754873 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:55:13.755384 [debug] [MainThread]: On master: COMMIT
[0m19:55:13.755909 [debug] [MainThread]: Using duckdb connection "master"
[0m19:55:13.756351 [debug] [MainThread]: On master: COMMIT
[0m19:55:13.757347 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:55:13.757897 [debug] [MainThread]: On master: Close
[0m19:55:13.761933 [debug] [Thread-1 (]: Began running node model.taxi_co2.transform
[0m19:55:13.762898 [info ] [Thread-1 (]: 1 of 1 START sql view model main.transform ..................................... [RUN]
[0m19:55:13.763696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_emissions_main, now model.taxi_co2.transform)
[0m19:55:13.764339 [debug] [Thread-1 (]: Began compiling node model.taxi_co2.transform
[0m19:55:13.787983 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_co2.transform"
[0m19:55:13.796835 [debug] [Thread-1 (]: Began executing node model.taxi_co2.transform
[0m19:55:13.864639 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_co2.transform"
[0m19:55:13.865728 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m19:55:13.866309 [debug] [Thread-1 (]: On model.taxi_co2.transform: BEGIN
[0m19:55:13.866921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:13.870416 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:55:13.877985 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m19:55:13.878878 [debug] [Thread-1 (]: On model.taxi_co2.transform: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

  
  create view "emissions"."main"."transform__dbt_tmp" as (
    { { config(materialized = 'table') } } -- yellow taxi transformations
-- add CO2_PER_TRIP_KGS column
ALTER TABLE yellow_taxi
ADD COLUMN IF NOT EXISTS co2_per_trip_kgs DOUBLE;
UPDATE yellow_taxi y
SET co2_per_trip_kgs = (y.trip_distance * v.co2_grams_per_mile) / 1000.0
FROM vehicle_emissions v
WHERE v.vehicle_type = 'yellow_taxi';
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS AVG_MPH_PER_TRIP FLOAT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS TRIP_HOURS FLOAT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS TRIP_DAY_OF_WEEK INT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS WEEK_NUMBER INT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS MONTH_NUMBER INT;
  );

[0m19:55:13.880416 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

  
  create view "emissions"."main"."transform__dbt_tmp" as (
    { { config(materialized = 'table') } } -- yellow taxi transformations
-- add CO2_PER_TRIP_KGS column
ALTER TABLE yellow_taxi
ADD COLUMN IF NOT EXISTS co2_per_trip_kgs DOUBLE;
UPDATE yellow_taxi y
SET co2_per_trip_kgs = (y.trip_distance * v.co2_grams_per_mile) / 1000.0
FROM vehicle_emissions v
WHERE v.vehicle_type = 'yellow_taxi';
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS AVG_MPH_PER_TRIP FLOAT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS TRIP_HOURS FLOAT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS TRIP_DAY_OF_WEEK INT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS WEEK_NUMBER INT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS MONTH_NUMBER INT;
  );

[0m19:55:13.881317 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m19:55:13.882394 [debug] [Thread-1 (]: On model.taxi_co2.transform: ROLLBACK
[0m19:55:13.885158 [debug] [Thread-1 (]: Failed to rollback 'model.taxi_co2.transform'
[0m19:55:13.885925 [debug] [Thread-1 (]: On model.taxi_co2.transform: Close
[0m19:55:13.897401 [debug] [Thread-1 (]: Runtime Error in model transform (models/transform.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'table') } } -- yellow taxi trans...
              ^
[0m19:55:13.900650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbcfa0ad-620f-4465-bddf-944846c1d041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bd828d90>]}
[0m19:55:13.901987 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.transform ............................ [[31mERROR[0m in 0.13s]
[0m19:55:13.903266 [debug] [Thread-1 (]: Finished running node model.taxi_co2.transform
[0m19:55:13.904489 [debug] [Thread-7 (]: Marking all children of 'model.taxi_co2.transform' to be skipped because of status 'error'.  Reason: Runtime Error in model transform (models/transform.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'table') } } -- yellow taxi trans...
              ^.
[0m19:55:13.908075 [debug] [MainThread]: Using duckdb connection "master"
[0m19:55:13.908942 [debug] [MainThread]: On master: BEGIN
[0m19:55:13.909660 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:55:13.911418 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:55:13.912224 [debug] [MainThread]: On master: COMMIT
[0m19:55:13.912895 [debug] [MainThread]: Using duckdb connection "master"
[0m19:55:13.913506 [debug] [MainThread]: On master: COMMIT
[0m19:55:13.925730 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:55:13.926700 [debug] [MainThread]: On master: Close
[0m19:55:13.927980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:55:13.928711 [debug] [MainThread]: Connection 'model.taxi_co2.transform' was properly closed.
[0m19:55:13.930150 [info ] [MainThread]: 
[0m19:55:13.931095 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m19:55:13.934820 [debug] [MainThread]: Command end result
[0m19:55:13.982827 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m19:55:13.985398 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m19:55:13.997846 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/ethancao/ds3022-data-project-1/dbt/target/run_results.json
[0m19:55:13.998420 [info ] [MainThread]: 
[0m19:55:13.999466 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:55:14.000107 [info ] [MainThread]: 
[0m19:55:14.000752 [error] [MainThread]: [31mFailure in model transform (models/transform.sql)[0m
[0m19:55:14.001407 [error] [MainThread]:   Runtime Error in model transform (models/transform.sql)
  Parser Error: syntax error at or near "{"
  
  LINE 5:     { { config(materialized = 'table') } } -- yellow taxi trans...
              ^
[0m19:55:14.001958 [info ] [MainThread]: 
[0m19:55:14.002560 [info ] [MainThread]:   compiled code at target/compiled/taxi_co2/models/transform.sql
[0m19:55:14.003055 [info ] [MainThread]: 
[0m19:55:14.003738 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:55:14.004934 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.44342, "process_in_blocks": "0", "process_kernel_time": 0.291573, "process_mem_max_rss": "204604", "process_out_blocks": "1800", "process_user_time": 2.945894}
[0m19:55:14.005963 [debug] [MainThread]: Command `dbt run` failed at 19:55:14.005752 after 1.44 seconds
[0m19:55:14.006990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22be9559f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bd81ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22be971720>]}
[0m19:55:14.007844 [debug] [MainThread]: Flushing usage events
[0m19:55:14.193294 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:57:30.955272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd4b319f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd3ac11e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd3ac1180>]}


============================== 19:57:30.958811 | 2e440f5e-8c14-4253-a6af-38607735a3e4 ==============================
[0m19:57:30.958811 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:57:30.959633 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'debug': 'False', 'fail_fast': 'False', 'quiet': 'False', 'log_path': '/home/ethancao/ds3022-data-project-1/dbt/logs', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'profiles_dir': '/home/ethancao/ds3022-data-project-1/dbt', 'partial_parse': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_cache_events': 'False'}
[0m19:57:31.308641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e440f5e-8c14-4253-a6af-38607735a3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd39e6c50>]}
[0m19:57:31.417431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e440f5e-8c14-4253-a6af-38607735a3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd3cd2200>]}
[0m19:57:31.419651 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m19:57:31.531586 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:57:31.674301 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m19:57:31.675067 [debug] [MainThread]: Partial parsing: added file: taxi_co2://models/staging/transform.sql
[0m19:57:31.675591 [debug] [MainThread]: Partial parsing: deleted file: taxi_co2://models/transform.sql
[0m19:57:32.087473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e440f5e-8c14-4253-a6af-38607735a3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd3b09b40>]}
[0m19:57:32.185831 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m19:57:32.188043 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m19:57:32.200650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e440f5e-8c14-4253-a6af-38607735a3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc5be7dc0>]}
[0m19:57:32.201456 [info ] [MainThread]: Found 1 model, 3 sources, 431 macros
[0m19:57:32.202086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e440f5e-8c14-4253-a6af-38607735a3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc5be43a0>]}
[0m19:57:32.204078 [info ] [MainThread]: 
[0m19:57:32.204753 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:57:32.205329 [info ] [MainThread]: 
[0m19:57:32.206650 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:57:32.208376 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_emissions'
[0m19:57:32.299698 [debug] [ThreadPool]: Using duckdb connection "list_emissions"
[0m19:57:32.300713 [debug] [ThreadPool]: On list_emissions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"emissions"'
    
  
  
[0m19:57:32.301461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:32.358336 [debug] [ThreadPool]: SQL status: OK in 0.057 seconds
[0m19:57:32.361543 [debug] [ThreadPool]: On list_emissions: Close
[0m19:57:32.363272 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_emissions, now create_emissions_main)
[0m19:57:32.364433 [debug] [ThreadPool]: Creating schema "database: "emissions"
schema: "main"
"
[0m19:57:32.374708 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m19:57:32.375570 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='emissions'
        and type='sqlite'
    
  
[0m19:57:32.376179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:57:32.378703 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m19:57:32.380632 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m19:57:32.381335 [debug] [ThreadPool]: On create_emissions_main: BEGIN
[0m19:57:32.382350 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:57:32.382827 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m19:57:32.383259 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
    
        create schema if not exists "emissions"."main"
    
[0m19:57:32.384526 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:57:32.385635 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m19:57:32.386156 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m19:57:32.386608 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m19:57:32.387585 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:57:32.388139 [debug] [ThreadPool]: On create_emissions_main: Close
[0m19:57:32.389781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_emissions_main, now list_emissions_main)
[0m19:57:32.396397 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m19:57:32.396899 [debug] [ThreadPool]: On list_emissions_main: BEGIN
[0m19:57:32.397428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:57:32.398481 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:57:32.398946 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m19:57:32.399466 [debug] [ThreadPool]: On list_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions_main"} */
select
      'emissions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'emissions'
  
[0m19:57:32.412248 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m19:57:32.413992 [debug] [ThreadPool]: On list_emissions_main: ROLLBACK
[0m19:57:32.414724 [debug] [ThreadPool]: Failed to rollback 'list_emissions_main'
[0m19:57:32.415173 [debug] [ThreadPool]: On list_emissions_main: Close
[0m19:57:32.416953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e440f5e-8c14-4253-a6af-38607735a3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc7e2bbb0>]}
[0m19:57:32.417799 [debug] [MainThread]: Using duckdb connection "master"
[0m19:57:32.418284 [debug] [MainThread]: On master: BEGIN
[0m19:57:32.418813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:57:32.419952 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:57:32.420427 [debug] [MainThread]: On master: COMMIT
[0m19:57:32.420877 [debug] [MainThread]: Using duckdb connection "master"
[0m19:57:32.421297 [debug] [MainThread]: On master: COMMIT
[0m19:57:32.422159 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:57:32.422656 [debug] [MainThread]: On master: Close
[0m19:57:32.427027 [debug] [Thread-1 (]: Began running node model.taxi_co2.transform
[0m19:57:32.428053 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform .................................... [RUN]
[0m19:57:32.428735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_emissions_main, now model.taxi_co2.transform)
[0m19:57:32.429218 [debug] [Thread-1 (]: Began compiling node model.taxi_co2.transform
[0m19:57:32.437052 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_co2.transform"
[0m19:57:32.438564 [debug] [Thread-1 (]: Began executing node model.taxi_co2.transform
[0m19:57:32.488809 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_co2.transform"
[0m19:57:32.489919 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m19:57:32.490449 [debug] [Thread-1 (]: On model.taxi_co2.transform: BEGIN
[0m19:57:32.490969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:32.492417 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:57:32.492991 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m19:57:32.493470 [debug] [Thread-1 (]: On model.taxi_co2.transform: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

  
    
    

    create  table
      "emissions"."main"."transform__dbt_tmp"
  
    as (
      -- yellow taxi transformations
-- add CO2_PER_TRIP_KGS column
ALTER TABLE yellow_taxi
ADD COLUMN IF NOT EXISTS co2_per_trip_kgs DOUBLE;
UPDATE yellow_taxi y
SET co2_per_trip_kgs = (y.trip_distance * v.co2_grams_per_mile) / 1000.0
FROM vehicle_emissions v
WHERE v.vehicle_type = 'yellow_taxi';
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS AVG_MPH_PER_TRIP FLOAT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS TRIP_HOURS FLOAT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS TRIP_DAY_OF_WEEK INT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS WEEK_NUMBER INT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS MONTH_NUMBER INT;
    );
  
  
[0m19:57:32.494306 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

  
    
    

    create  table
      "emissions"."main"."transform__dbt_tmp"
  
    as (
      -- yellow taxi transformations
-- add CO2_PER_TRIP_KGS column
ALTER TABLE yellow_taxi
ADD COLUMN IF NOT EXISTS co2_per_trip_kgs DOUBLE;
UPDATE yellow_taxi y
SET co2_per_trip_kgs = (y.trip_distance * v.co2_grams_per_mile) / 1000.0
FROM vehicle_emissions v
WHERE v.vehicle_type = 'yellow_taxi';
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS AVG_MPH_PER_TRIP FLOAT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS TRIP_HOURS FLOAT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS TRIP_DAY_OF_WEEK INT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS WEEK_NUMBER INT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS MONTH_NUMBER INT;
    );
  
  
[0m19:57:32.496050 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m19:57:32.497810 [debug] [Thread-1 (]: On model.taxi_co2.transform: ROLLBACK
[0m19:57:32.501385 [debug] [Thread-1 (]: Failed to rollback 'model.taxi_co2.transform'
[0m19:57:32.501933 [debug] [Thread-1 (]: On model.taxi_co2.transform: Close
[0m19:57:32.503505 [debug] [Thread-1 (]: Runtime Error in model transform (models/staging/transform.sql)
  Parser Error: syntax error at or near "ALTER"
  
  LINE 13: ALTER TABLE yellow_taxi
           ^
[0m19:57:32.506147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e440f5e-8c14-4253-a6af-38607735a3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc5bb5f00>]}
[0m19:57:32.507025 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.transform ........................... [[31mERROR[0m in 0.08s]
[0m19:57:32.507836 [debug] [Thread-1 (]: Finished running node model.taxi_co2.transform
[0m19:57:32.508614 [debug] [Thread-7 (]: Marking all children of 'model.taxi_co2.transform' to be skipped because of status 'error'.  Reason: Runtime Error in model transform (models/staging/transform.sql)
  Parser Error: syntax error at or near "ALTER"
  
  LINE 13: ALTER TABLE yellow_taxi
           ^.
[0m19:57:32.511333 [debug] [MainThread]: Using duckdb connection "master"
[0m19:57:32.511861 [debug] [MainThread]: On master: BEGIN
[0m19:57:32.512296 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:57:32.513548 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:57:32.514062 [debug] [MainThread]: On master: COMMIT
[0m19:57:32.514723 [debug] [MainThread]: Using duckdb connection "master"
[0m19:57:32.515340 [debug] [MainThread]: On master: COMMIT
[0m19:57:32.516669 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:57:32.517395 [debug] [MainThread]: On master: Close
[0m19:57:32.518242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:57:32.518872 [debug] [MainThread]: Connection 'model.taxi_co2.transform' was properly closed.
[0m19:57:32.519591 [info ] [MainThread]: 
[0m19:57:32.520519 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m19:57:32.521738 [debug] [MainThread]: Command end result
[0m19:57:32.557496 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m19:57:32.560221 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m19:57:32.571757 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/ethancao/ds3022-data-project-1/dbt/target/run_results.json
[0m19:57:32.572603 [info ] [MainThread]: 
[0m19:57:32.573533 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:57:32.574303 [info ] [MainThread]: 
[0m19:57:32.575014 [error] [MainThread]: [31mFailure in model transform (models/staging/transform.sql)[0m
[0m19:57:32.575663 [error] [MainThread]:   Runtime Error in model transform (models/staging/transform.sql)
  Parser Error: syntax error at or near "ALTER"
  
  LINE 13: ALTER TABLE yellow_taxi
           ^
[0m19:57:32.576200 [info ] [MainThread]: 
[0m19:57:32.576817 [info ] [MainThread]:   compiled code at target/compiled/taxi_co2/models/staging/transform.sql
[0m19:57:32.577345 [info ] [MainThread]: 
[0m19:57:32.577988 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:57:32.579331 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.693996, "process_in_blocks": "0", "process_kernel_time": 0.198376, "process_mem_max_rss": "207300", "process_out_blocks": "2664", "process_user_time": 3.243455}
[0m19:57:32.581083 [debug] [MainThread]: Command `dbt run` failed at 19:57:32.580072 after 1.70 seconds
[0m19:57:32.581791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd4b319f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd4b4d4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd66dffa00>]}
[0m19:57:32.582835 [debug] [MainThread]: Flushing usage events
[0m19:57:32.764684 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:25:57.789068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e46bc19c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e45b4c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e45b4c250>]}


============================== 20:25:57.795681 | 4c952f3d-0870-4729-81dc-d04f5e70e570 ==============================
[0m20:25:57.795681 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:25:57.796836 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'version_check': 'True', 'log_path': '/home/ethancao/ds3022-data-project-1/dbt/logs', 'warn_error': 'None', 'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'empty': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_format': 'default', 'profiles_dir': '/home/ethancao/ds3022-data-project-1/dbt', 'quiet': 'False', 'fail_fast': 'False'}
[0m20:25:58.270534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c952f3d-0870-4729-81dc-d04f5e70e570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e4694c880>]}
[0m20:25:58.364803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c952f3d-0870-4729-81dc-d04f5e70e570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e45b98520>]}
[0m20:25:58.369567 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m20:25:58.492509 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:25:58.692686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:25:58.693530 [debug] [MainThread]: Partial parsing: updated file: taxi_co2://models/staging/transform.sql
[0m20:25:59.141622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c952f3d-0870-4729-81dc-d04f5e70e570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e45b163e0>]}
[0m20:25:59.247503 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m20:25:59.250723 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m20:25:59.284886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c952f3d-0870-4729-81dc-d04f5e70e570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e45af9870>]}
[0m20:25:59.285740 [info ] [MainThread]: Found 1 model, 3 sources, 431 macros
[0m20:25:59.286390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c952f3d-0870-4729-81dc-d04f5e70e570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e45a12cb0>]}
[0m20:25:59.289154 [info ] [MainThread]: 
[0m20:25:59.289843 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:25:59.290297 [info ] [MainThread]: 
[0m20:25:59.293960 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:25:59.296546 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_emissions'
[0m20:25:59.380082 [debug] [ThreadPool]: Using duckdb connection "list_emissions"
[0m20:25:59.380828 [debug] [ThreadPool]: On list_emissions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"emissions"'
    
  
  
[0m20:25:59.381371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:59.453854 [debug] [ThreadPool]: SQL status: OK in 0.072 seconds
[0m20:25:59.456465 [debug] [ThreadPool]: On list_emissions: Close
[0m20:25:59.458285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_emissions, now create_emissions_main)
[0m20:25:59.459204 [debug] [ThreadPool]: Creating schema "database: "emissions"
schema: "main"
"
[0m20:25:59.469423 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m20:25:59.470032 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='emissions'
        and type='sqlite'
    
  
[0m20:25:59.470494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:59.472100 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:25:59.473779 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m20:25:59.474358 [debug] [ThreadPool]: On create_emissions_main: BEGIN
[0m20:25:59.476424 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:25:59.476987 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m20:25:59.477519 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
    
        create schema if not exists "emissions"."main"
    
[0m20:25:59.478621 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:25:59.479854 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m20:25:59.480445 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m20:25:59.480949 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m20:25:59.482131 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:25:59.482831 [debug] [ThreadPool]: On create_emissions_main: Close
[0m20:25:59.485078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_emissions_main, now list_emissions_main)
[0m20:25:59.493139 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m20:25:59.493893 [debug] [ThreadPool]: On list_emissions_main: BEGIN
[0m20:25:59.494469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:59.497466 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:25:59.498423 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m20:25:59.499017 [debug] [ThreadPool]: On list_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions_main"} */
select
      'emissions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'emissions'
  
[0m20:25:59.522790 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:25:59.524673 [debug] [ThreadPool]: On list_emissions_main: ROLLBACK
[0m20:25:59.526246 [debug] [ThreadPool]: Failed to rollback 'list_emissions_main'
[0m20:25:59.526775 [debug] [ThreadPool]: On list_emissions_main: Close
[0m20:25:59.528969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c952f3d-0870-4729-81dc-d04f5e70e570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e17c5e290>]}
[0m20:25:59.529654 [debug] [MainThread]: Using duckdb connection "master"
[0m20:25:59.530116 [debug] [MainThread]: On master: BEGIN
[0m20:25:59.530497 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:25:59.531543 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:25:59.532123 [debug] [MainThread]: On master: COMMIT
[0m20:25:59.532663 [debug] [MainThread]: Using duckdb connection "master"
[0m20:25:59.533106 [debug] [MainThread]: On master: COMMIT
[0m20:25:59.534014 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:25:59.534479 [debug] [MainThread]: On master: Close
[0m20:25:59.540537 [debug] [Thread-1 (]: Began running node model.taxi_co2.transform
[0m20:25:59.541566 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform .................................... [RUN]
[0m20:25:59.542313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_emissions_main, now model.taxi_co2.transform)
[0m20:25:59.542812 [debug] [Thread-1 (]: Began compiling node model.taxi_co2.transform
[0m20:25:59.554307 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_co2.transform"
[0m20:25:59.557631 [debug] [Thread-1 (]: Began executing node model.taxi_co2.transform
[0m20:25:59.633094 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_co2.transform"
[0m20:25:59.640127 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m20:25:59.640954 [debug] [Thread-1 (]: On model.taxi_co2.transform: BEGIN
[0m20:25:59.641687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:59.643471 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:25:59.644245 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m20:25:59.645170 [debug] [Thread-1 (]: On model.taxi_co2.transform: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

  
    
    

    create  table
      "emissions"."main"."transform__dbt_tmp"
  
    as (
      -- yellow taxi transformations
-- add CO2_PER_TRIP_KGS column
SELECT yellow_taxi.*,
    (
        yellow_taxi.trip_distance * (
            SELECT co2_grams_per_mile
            FROM vehicle_emissions
            WHERE vehicle_type = 'yellow_taxi'
        )
    ) / 1000 AS CO2_PER_TRIP_KGS
FROM yellow_taxi;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS AVG_MPH_PER_TRIP FLOAT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS TRIP_HOURS FLOAT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS TRIP_DAY_OF_WEEK INT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS WEEK_NUMBER INT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS MONTH_NUMBER INT;
    );
  
  
[0m20:25:59.652905 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

  
    
    

    create  table
      "emissions"."main"."transform__dbt_tmp"
  
    as (
      -- yellow taxi transformations
-- add CO2_PER_TRIP_KGS column
SELECT yellow_taxi.*,
    (
        yellow_taxi.trip_distance * (
            SELECT co2_grams_per_mile
            FROM vehicle_emissions
            WHERE vehicle_type = 'yellow_taxi'
        )
    ) / 1000 AS CO2_PER_TRIP_KGS
FROM yellow_taxi;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS AVG_MPH_PER_TRIP FLOAT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS TRIP_HOURS FLOAT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS TRIP_DAY_OF_WEEK INT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS WEEK_NUMBER INT;
-- ALTER TABLE yellow_taxi
-- ADD COLUMN IF NOT EXISTS MONTH_NUMBER INT;
    );
  
  
[0m20:25:59.653915 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:25:59.655056 [debug] [Thread-1 (]: On model.taxi_co2.transform: ROLLBACK
[0m20:25:59.662956 [debug] [Thread-1 (]: Failed to rollback 'model.taxi_co2.transform'
[0m20:25:59.663804 [debug] [Thread-1 (]: On model.taxi_co2.transform: Close
[0m20:25:59.665967 [debug] [Thread-1 (]: Runtime Error in model transform (models/staging/transform.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 21: FROM yellow_taxi;
                           ^
[0m20:25:59.669248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c952f3d-0870-4729-81dc-d04f5e70e570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e17c5e290>]}
[0m20:25:59.670543 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.transform ........................... [[31mERROR[0m in 0.12s]
[0m20:25:59.671818 [debug] [Thread-1 (]: Finished running node model.taxi_co2.transform
[0m20:25:59.672716 [debug] [Thread-7 (]: Marking all children of 'model.taxi_co2.transform' to be skipped because of status 'error'.  Reason: Runtime Error in model transform (models/staging/transform.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 21: FROM yellow_taxi;
                           ^.
[0m20:25:59.675722 [debug] [MainThread]: Using duckdb connection "master"
[0m20:25:59.676290 [debug] [MainThread]: On master: BEGIN
[0m20:25:59.676892 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:25:59.678280 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:25:59.678913 [debug] [MainThread]: On master: COMMIT
[0m20:25:59.679609 [debug] [MainThread]: Using duckdb connection "master"
[0m20:25:59.680254 [debug] [MainThread]: On master: COMMIT
[0m20:25:59.681565 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:25:59.682289 [debug] [MainThread]: On master: Close
[0m20:25:59.683230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:59.683737 [debug] [MainThread]: Connection 'model.taxi_co2.transform' was properly closed.
[0m20:25:59.685070 [info ] [MainThread]: 
[0m20:25:59.688822 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m20:25:59.694318 [debug] [MainThread]: Command end result
[0m20:25:59.726115 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m20:25:59.729046 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m20:25:59.736930 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/ethancao/ds3022-data-project-1/dbt/target/run_results.json
[0m20:25:59.738089 [info ] [MainThread]: 
[0m20:25:59.739124 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:25:59.739861 [info ] [MainThread]: 
[0m20:25:59.740800 [error] [MainThread]: [31mFailure in model transform (models/staging/transform.sql)[0m
[0m20:25:59.741510 [error] [MainThread]:   Runtime Error in model transform (models/staging/transform.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 21: FROM yellow_taxi;
                           ^
[0m20:25:59.742055 [info ] [MainThread]: 
[0m20:25:59.742694 [info ] [MainThread]:   compiled code at target/compiled/taxi_co2/models/staging/transform.sql
[0m20:25:59.743228 [info ] [MainThread]: 
[0m20:25:59.743928 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:25:59.746245 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.046672, "process_in_blocks": "160432", "process_kernel_time": 0.43953, "process_mem_max_rss": "207984", "process_out_blocks": "2664", "process_user_time": 3.422056}
[0m20:25:59.747512 [debug] [MainThread]: Command `dbt run` failed at 20:25:59.747036 after 2.05 seconds
[0m20:25:59.748332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e46bc19c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e46a9efb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e48638cd0>]}
[0m20:25:59.749180 [debug] [MainThread]: Flushing usage events
[0m20:25:59.924005 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:27:19.142252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d4c499f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d3bf11e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d3bf1180>]}


============================== 20:27:19.145613 | f93c3db0-eb18-444c-9568-5ace8ba1717a ==============================
[0m20:27:19.145613 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:27:19.146594 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/ethancao/ds3022-data-project-1/dbt', 'use_colors': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'write_json': 'True', 'version_check': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'log_format': 'default', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_path': '/home/ethancao/ds3022-data-project-1/dbt/logs', 'empty': 'False', 'fail_fast': 'False', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None'}
[0m20:27:19.471380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f93c3db0-eb18-444c-9568-5ace8ba1717a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d3b12c50>]}
[0m20:27:19.562479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f93c3db0-eb18-444c-9568-5ace8ba1717a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d3e0a200>]}
[0m20:27:19.564941 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m20:27:19.674307 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:27:19.859830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:27:19.860781 [debug] [MainThread]: Partial parsing: updated file: taxi_co2://models/staging/transform.sql
[0m20:27:20.288755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f93c3db0-eb18-444c-9568-5ace8ba1717a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d3a81b40>]}
[0m20:27:20.444566 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m20:27:20.461223 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m20:27:20.475609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f93c3db0-eb18-444c-9568-5ace8ba1717a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c5cfec20>]}
[0m20:27:20.476511 [info ] [MainThread]: Found 1 model, 3 sources, 431 macros
[0m20:27:20.477150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f93c3db0-eb18-444c-9568-5ace8ba1717a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c5cfee60>]}
[0m20:27:20.479385 [info ] [MainThread]: 
[0m20:27:20.480089 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:27:20.480661 [info ] [MainThread]: 
[0m20:27:20.481495 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:27:20.482874 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_emissions'
[0m20:27:20.528939 [debug] [ThreadPool]: Using duckdb connection "list_emissions"
[0m20:27:20.529595 [debug] [ThreadPool]: On list_emissions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"emissions"'
    
  
  
[0m20:27:20.530039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:20.588530 [debug] [ThreadPool]: SQL status: OK in 0.058 seconds
[0m20:27:20.590377 [debug] [ThreadPool]: On list_emissions: Close
[0m20:27:20.591700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_emissions, now create_emissions_main)
[0m20:27:20.592378 [debug] [ThreadPool]: Creating schema "database: "emissions"
schema: "main"
"
[0m20:27:20.601694 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m20:27:20.602441 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='emissions'
        and type='sqlite'
    
  
[0m20:27:20.602895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:20.604646 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:27:20.606302 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m20:27:20.606791 [debug] [ThreadPool]: On create_emissions_main: BEGIN
[0m20:27:20.607810 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:27:20.608250 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m20:27:20.608698 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
    
        create schema if not exists "emissions"."main"
    
[0m20:27:20.609614 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:27:20.610615 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m20:27:20.611098 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m20:27:20.611550 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m20:27:20.612374 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:27:20.612812 [debug] [ThreadPool]: On create_emissions_main: Close
[0m20:27:20.614397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_emissions_main, now list_emissions_main)
[0m20:27:20.621115 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m20:27:20.621608 [debug] [ThreadPool]: On list_emissions_main: BEGIN
[0m20:27:20.622051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:20.623096 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:27:20.623666 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m20:27:20.624097 [debug] [ThreadPool]: On list_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions_main"} */
select
      'emissions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'emissions'
  
[0m20:27:20.637480 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:27:20.639201 [debug] [ThreadPool]: On list_emissions_main: ROLLBACK
[0m20:27:20.640036 [debug] [ThreadPool]: Failed to rollback 'list_emissions_main'
[0m20:27:20.640536 [debug] [ThreadPool]: On list_emissions_main: Close
[0m20:27:20.642368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f93c3db0-eb18-444c-9568-5ace8ba1717a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d44575b0>]}
[0m20:27:20.643037 [debug] [MainThread]: Using duckdb connection "master"
[0m20:27:20.643491 [debug] [MainThread]: On master: BEGIN
[0m20:27:20.643883 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:27:20.644875 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:27:20.645351 [debug] [MainThread]: On master: COMMIT
[0m20:27:20.645758 [debug] [MainThread]: Using duckdb connection "master"
[0m20:27:20.646172 [debug] [MainThread]: On master: COMMIT
[0m20:27:20.647172 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:27:20.647864 [debug] [MainThread]: On master: Close
[0m20:27:20.653284 [debug] [Thread-1 (]: Began running node model.taxi_co2.transform
[0m20:27:20.654306 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform .................................... [RUN]
[0m20:27:20.655156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_emissions_main, now model.taxi_co2.transform)
[0m20:27:20.655699 [debug] [Thread-1 (]: Began compiling node model.taxi_co2.transform
[0m20:27:20.669460 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_co2.transform"
[0m20:27:20.672528 [debug] [Thread-1 (]: Began executing node model.taxi_co2.transform
[0m20:27:20.728705 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_co2.transform"
[0m20:27:20.729717 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m20:27:20.730244 [debug] [Thread-1 (]: On model.taxi_co2.transform: BEGIN
[0m20:27:20.730702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:20.732071 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:27:20.732629 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m20:27:20.733175 [debug] [Thread-1 (]: On model.taxi_co2.transform: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

  
    
    

    create  table
      "emissions"."main"."transform__dbt_tmp"
  
    as (
      -- yellow taxi transformations
-- add CO2_PER_TRIP_KGS column
SELECT yellow_taxi.*,
    (
        yellow_taxi.trip_distance * (
            SELECT co2_grams_per_mile
            FROM vehicle_emissions
            WHERE vehicle_type = 'yellow_taxi'
        )
    ) / 1000 AS CO2_PER_TRIP_KGS
FROM yellow_taxi -- ALTER TABLE yellow_taxi
    -- ADD COLUMN IF NOT EXISTS AVG_MPH_PER_TRIP FLOAT;
    -- ALTER TABLE yellow_taxi
    -- ADD COLUMN IF NOT EXISTS TRIP_HOURS FLOAT;
    -- ALTER TABLE yellow_taxi
    -- ADD COLUMN IF NOT EXISTS TRIP_DAY_OF_WEEK INT;
    -- ALTER TABLE yellow_taxi
    -- ADD COLUMN IF NOT EXISTS WEEK_NUMBER INT;
    -- ALTER TABLE yellow_taxi
    -- ADD COLUMN IF NOT EXISTS MONTH_NUMBER INT;
    );
  
  
[0m20:29:03.643024 [debug] [Thread-1 (]: SQL status: OK in 102.818 seconds
[0m20:29:04.595455 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m20:29:04.600183 [debug] [Thread-1 (]: On model.taxi_co2.transform: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */
alter table "emissions"."main"."transform__dbt_tmp" rename to "transform"
[0m20:29:04.638512 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m20:29:04.834794 [debug] [Thread-1 (]: On model.taxi_co2.transform: COMMIT
[0m20:29:04.837653 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m20:29:04.838977 [debug] [Thread-1 (]: On model.taxi_co2.transform: COMMIT
[0m20:29:06.405208 [debug] [Thread-1 (]: SQL status: OK in 1.564 seconds
[0m20:29:06.426095 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m20:29:06.429456 [debug] [Thread-1 (]: On model.taxi_co2.transform: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

      drop table if exists "emissions"."main"."transform__dbt_backup" cascade
    
[0m20:29:06.434722 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:29:06.568834 [debug] [Thread-1 (]: On model.taxi_co2.transform: Close
[0m20:29:06.669477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f93c3db0-eb18-444c-9568-5ace8ba1717a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d44575b0>]}
[0m20:29:06.712311 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.transform ............................... [[32mOK[0m in 105.94s]
[0m20:29:06.725178 [debug] [Thread-1 (]: Finished running node model.taxi_co2.transform
[0m20:29:06.803358 [debug] [MainThread]: Using duckdb connection "master"
[0m20:29:06.805928 [debug] [MainThread]: On master: BEGIN
[0m20:29:06.808135 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:29:06.844664 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m20:29:06.846629 [debug] [MainThread]: On master: COMMIT
[0m20:29:06.847684 [debug] [MainThread]: Using duckdb connection "master"
[0m20:29:06.848447 [debug] [MainThread]: On master: COMMIT
[0m20:29:06.853067 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m20:29:06.853941 [debug] [MainThread]: On master: Close
[0m20:29:06.880770 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:29:06.881885 [debug] [MainThread]: Connection 'model.taxi_co2.transform' was properly closed.
[0m20:29:06.888725 [info ] [MainThread]: 
[0m20:29:06.895164 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 46.40 seconds (106.40s).
[0m20:29:06.916164 [debug] [MainThread]: Command end result
[0m20:29:07.142292 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m20:29:07.264837 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m20:29:07.423213 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/ethancao/ds3022-data-project-1/dbt/target/run_results.json
[0m20:29:07.424450 [info ] [MainThread]: 
[0m20:29:07.436431 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:29:07.438677 [info ] [MainThread]: 
[0m20:29:07.445020 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:29:07.514853 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 108.43425, "process_in_blocks": "22446072", "process_kernel_time": 495.2175, "process_mem_max_rss": "13410812", "process_out_blocks": "28168312", "process_user_time": 786.38873}
[0m20:29:07.538141 [debug] [MainThread]: Command `dbt run` succeeded at 20:29:07.535934 after 108.47 seconds
[0m20:29:07.554731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d4c499f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d4b26b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb096e65630>]}
[0m20:29:07.556650 [debug] [MainThread]: Flushing usage events
[0m20:29:08.047460 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:39:58.363408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b07261a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b061f1270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b061f1210>]}


============================== 20:39:58.368902 | e1840aef-80f9-4eb4-8c52-c93d7d0e688c ==============================
[0m20:39:58.368902 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:39:58.369859 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'warn_error': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'target_path': 'None', 'quiet': 'False', 'log_format': 'default', 'debug': 'False', 'printer_width': '80', 'static_parser': 'True', 'write_json': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/ethancao/ds3022-data-project-1/dbt', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'log_path': '/home/ethancao/ds3022-data-project-1/dbt/logs'}
[0m20:39:58.805575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1840aef-80f9-4eb4-8c52-c93d7d0e688c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b089f8af0>]}
[0m20:39:58.905419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1840aef-80f9-4eb4-8c52-c93d7d0e688c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b06a22ec0>]}
[0m20:39:58.909293 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m20:39:59.058677 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:39:59.356904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:39:59.358187 [debug] [MainThread]: Partial parsing: updated file: taxi_co2://models/staging/transform.sql
[0m20:39:59.811995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1840aef-80f9-4eb4-8c52-c93d7d0e688c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b06089d80>]}
[0m20:39:59.965433 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m20:39:59.968392 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m20:39:59.993909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1840aef-80f9-4eb4-8c52-c93d7d0e688c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af837c6a0>]}
[0m20:39:59.994715 [info ] [MainThread]: Found 1 model, 3 sources, 431 macros
[0m20:39:59.996352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1840aef-80f9-4eb4-8c52-c93d7d0e688c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af82f0190>]}
[0m20:39:59.999247 [info ] [MainThread]: 
[0m20:40:00.000123 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:40:00.000861 [info ] [MainThread]: 
[0m20:40:00.001944 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:40:00.003757 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_emissions'
[0m20:40:00.104254 [debug] [ThreadPool]: Using duckdb connection "list_emissions"
[0m20:40:00.104916 [debug] [ThreadPool]: On list_emissions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"emissions"'
    
  
  
[0m20:40:00.105360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:00.137894 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m20:40:00.140124 [debug] [ThreadPool]: On list_emissions: Close
[0m20:40:00.141810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_emissions, now create_emissions_main)
[0m20:40:00.142851 [debug] [ThreadPool]: Creating schema "database: "emissions"
schema: "main"
"
[0m20:40:00.156299 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m20:40:00.157045 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='emissions'
        and type='sqlite'
    
  
[0m20:40:00.157630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:00.160500 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:40:00.162544 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m20:40:00.163276 [debug] [ThreadPool]: On create_emissions_main: BEGIN
[0m20:40:00.166066 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:40:00.166870 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m20:40:00.167717 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
    
        create schema if not exists "emissions"."main"
    
[0m20:40:00.170101 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:40:00.171725 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m20:40:00.172431 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m20:40:00.173105 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m20:40:00.174300 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:40:00.174962 [debug] [ThreadPool]: On create_emissions_main: Close
[0m20:40:00.177611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_emissions_main, now list_emissions_main)
[0m20:40:00.187084 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m20:40:00.188016 [debug] [ThreadPool]: On list_emissions_main: BEGIN
[0m20:40:00.188617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:00.189912 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:40:00.190514 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m20:40:00.191059 [debug] [ThreadPool]: On list_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions_main"} */
select
      'emissions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'emissions'
  
[0m20:40:00.214595 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:40:00.217468 [debug] [ThreadPool]: On list_emissions_main: ROLLBACK
[0m20:40:00.219239 [debug] [ThreadPool]: Failed to rollback 'list_emissions_main'
[0m20:40:00.219877 [debug] [ThreadPool]: On list_emissions_main: Close
[0m20:40:00.222328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1840aef-80f9-4eb4-8c52-c93d7d0e688c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8afa52ed10>]}
[0m20:40:00.223048 [debug] [MainThread]: Using duckdb connection "master"
[0m20:40:00.223476 [debug] [MainThread]: On master: BEGIN
[0m20:40:00.223849 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:00.225016 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:40:00.225740 [debug] [MainThread]: On master: COMMIT
[0m20:40:00.226491 [debug] [MainThread]: Using duckdb connection "master"
[0m20:40:00.227262 [debug] [MainThread]: On master: COMMIT
[0m20:40:00.228561 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:40:00.229071 [debug] [MainThread]: On master: Close
[0m20:40:00.237383 [debug] [Thread-1 (]: Began running node model.taxi_co2.transform
[0m20:40:00.238303 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform .................................... [RUN]
[0m20:40:00.239240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_emissions_main, now model.taxi_co2.transform)
[0m20:40:00.239842 [debug] [Thread-1 (]: Began compiling node model.taxi_co2.transform
[0m20:40:00.256333 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_co2.transform"
[0m20:40:00.257341 [debug] [Thread-1 (]: Began executing node model.taxi_co2.transform
[0m20:40:00.355437 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_co2.transform"
[0m20:40:00.356697 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m20:40:00.357484 [debug] [Thread-1 (]: On model.taxi_co2.transform: BEGIN
[0m20:40:00.358118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:00.361902 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:40:00.362648 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m20:40:00.363359 [debug] [Thread-1 (]: On model.taxi_co2.transform: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

  
    
    

    create  table
      "emissions"."main"."transform__dbt_tmp"
  
    as (
      -- yellow taxi transformations
-- add CO2_PER_TRIP_KGS column
SELECT yellow_taxi.*,
    (
        yellow_taxi.trip_distance * (
            SELECT co2_grams_per_mile
            FROM vehicle_emissions
            WHERE vehicle_type = 'yellow_taxi'
        )
    ) / 1000 AS CO2_PER_TRIP_KGS
FROM yellow_taxi -- green taxi transformations
    -- add CO2_PER_TRIP_KGS column
SELECT green_taxi.*,
    (
        green_taxi.trip_distance * (
            SELECT co2_grams_per_mile
            FROM vehicle_emissions
            WHERE vehicle_type = 'green_taxi'
        )
    ) / 1000 AS CO2_PER_TRIP_KGS
FROM green_taxi -- calculate trip hour for yellow taxi
SELECT *,
    DATEDIFF(
        'second',
        tpep_pickup_datetime,
        tpep_dropoff_datetime
    ) / 3600 AS trip_hours
FROM yellow_taxi -- calculate trip hour for green taxi
SELECT *,
    DATEDIFF(
        'second',
        tpep_pickup_datetime,
        tpep_dropoff_datetime
    ) / 3600 AS trip_hours
FROM green_taxi
    );
  
  
[0m20:40:00.372141 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

  
    
    

    create  table
      "emissions"."main"."transform__dbt_tmp"
  
    as (
      -- yellow taxi transformations
-- add CO2_PER_TRIP_KGS column
SELECT yellow_taxi.*,
    (
        yellow_taxi.trip_distance * (
            SELECT co2_grams_per_mile
            FROM vehicle_emissions
            WHERE vehicle_type = 'yellow_taxi'
        )
    ) / 1000 AS CO2_PER_TRIP_KGS
FROM yellow_taxi -- green taxi transformations
    -- add CO2_PER_TRIP_KGS column
SELECT green_taxi.*,
    (
        green_taxi.trip_distance * (
            SELECT co2_grams_per_mile
            FROM vehicle_emissions
            WHERE vehicle_type = 'green_taxi'
        )
    ) / 1000 AS CO2_PER_TRIP_KGS
FROM green_taxi -- calculate trip hour for yellow taxi
SELECT *,
    DATEDIFF(
        'second',
        tpep_pickup_datetime,
        tpep_dropoff_datetime
    ) / 3600 AS trip_hours
FROM yellow_taxi -- calculate trip hour for green taxi
SELECT *,
    DATEDIFF(
        'second',
        tpep_pickup_datetime,
        tpep_dropoff_datetime
    ) / 3600 AS trip_hours
FROM green_taxi
    );
  
  
[0m20:40:00.372849 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:40:00.373583 [debug] [Thread-1 (]: On model.taxi_co2.transform: ROLLBACK
[0m20:40:00.380621 [debug] [Thread-1 (]: Failed to rollback 'model.taxi_co2.transform'
[0m20:40:00.381306 [debug] [Thread-1 (]: On model.taxi_co2.transform: Close
[0m20:40:00.382991 [debug] [Thread-1 (]: Runtime Error in model transform (models/staging/transform.sql)
  Parser Error: syntax error at or near "SELECT"
  
  LINE 23: SELECT green_taxi.*,
           ^
[0m20:40:00.385290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1840aef-80f9-4eb4-8c52-c93d7d0e688c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b061f30d0>]}
[0m20:40:00.386289 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.transform ........................... [[31mERROR[0m in 0.14s]
[0m20:40:00.387327 [debug] [Thread-1 (]: Finished running node model.taxi_co2.transform
[0m20:40:00.388595 [debug] [Thread-7 (]: Marking all children of 'model.taxi_co2.transform' to be skipped because of status 'error'.  Reason: Runtime Error in model transform (models/staging/transform.sql)
  Parser Error: syntax error at or near "SELECT"
  
  LINE 23: SELECT green_taxi.*,
           ^.
[0m20:40:00.391755 [debug] [MainThread]: Using duckdb connection "master"
[0m20:40:00.392306 [debug] [MainThread]: On master: BEGIN
[0m20:40:00.392730 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:40:00.394085 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:40:00.394629 [debug] [MainThread]: On master: COMMIT
[0m20:40:00.395125 [debug] [MainThread]: Using duckdb connection "master"
[0m20:40:00.395643 [debug] [MainThread]: On master: COMMIT
[0m20:40:00.396608 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:40:00.397099 [debug] [MainThread]: On master: Close
[0m20:40:00.397874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:00.398362 [debug] [MainThread]: Connection 'model.taxi_co2.transform' was properly closed.
[0m20:40:00.398858 [info ] [MainThread]: 
[0m20:40:00.399389 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m20:40:00.402195 [debug] [MainThread]: Command end result
[0m20:40:00.446453 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m20:40:00.449648 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m20:40:00.460323 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/ethancao/ds3022-data-project-1/dbt/target/run_results.json
[0m20:40:00.460928 [info ] [MainThread]: 
[0m20:40:00.461625 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:40:00.462200 [info ] [MainThread]: 
[0m20:40:00.464610 [error] [MainThread]: [31mFailure in model transform (models/staging/transform.sql)[0m
[0m20:40:00.465691 [error] [MainThread]:   Runtime Error in model transform (models/staging/transform.sql)
  Parser Error: syntax error at or near "SELECT"
  
  LINE 23: SELECT green_taxi.*,
           ^
[0m20:40:00.466584 [info ] [MainThread]: 
[0m20:40:00.467421 [info ] [MainThread]:   compiled code at target/compiled/taxi_co2/models/staging/transform.sql
[0m20:40:00.468094 [info ] [MainThread]: 
[0m20:40:00.468888 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:40:00.470527 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.2059815, "process_in_blocks": "49160", "process_kernel_time": 0.281082, "process_mem_max_rss": "205320", "process_out_blocks": "2672", "process_user_time": 3.433221}
[0m20:40:00.471392 [debug] [MainThread]: Command `dbt run` failed at 20:40:00.471218 after 2.21 seconds
[0m20:40:00.472190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b07261a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af827ed40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af84bb580>]}
[0m20:40:00.472980 [debug] [MainThread]: Flushing usage events
[0m20:40:00.649948 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:46:10.458213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1142dab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d103d5270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d103d5210>]}


============================== 20:46:10.461710 | a894b46d-fcb9-4067-ac3c-d062f031604d ==============================
[0m20:46:10.461710 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:46:10.462603 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'profiles_dir': '/home/ethancao/ds3022-data-project-1/dbt', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'partial_parse': 'True', 'printer_width': '80', 'no_print': 'None', 'introspect': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'log_cache_events': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'target_path': 'None', 'log_path': '/home/ethancao/ds3022-data-project-1/dbt/logs'}
[0m20:46:10.844905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a894b46d-fcb9-4067-ac3c-d062f031604d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d103d4700>]}
[0m20:46:10.938434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a894b46d-fcb9-4067-ac3c-d062f031604d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d103cdc00>]}
[0m20:46:10.940539 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m20:46:11.052954 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:46:11.234254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:46:11.235229 [debug] [MainThread]: Partial parsing: updated file: taxi_co2://models/staging/transform.sql
[0m20:46:11.817770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a894b46d-fcb9-4067-ac3c-d062f031604d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d04765b70>]}
[0m20:46:11.941795 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m20:46:11.944145 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m20:46:11.958030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a894b46d-fcb9-4067-ac3c-d062f031604d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d10380e50>]}
[0m20:46:11.959064 [info ] [MainThread]: Found 1 model, 3 sources, 431 macros
[0m20:46:11.960049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a894b46d-fcb9-4067-ac3c-d062f031604d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc42f4a30>]}
[0m20:46:11.963459 [info ] [MainThread]: 
[0m20:46:11.965026 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:46:11.965725 [info ] [MainThread]: 
[0m20:46:11.968913 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:46:11.973096 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_emissions'
[0m20:46:12.033822 [debug] [ThreadPool]: Using duckdb connection "list_emissions"
[0m20:46:12.034579 [debug] [ThreadPool]: On list_emissions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"emissions"'
    
  
  
[0m20:46:12.035158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:12.071431 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m20:46:12.074604 [debug] [ThreadPool]: On list_emissions: Close
[0m20:46:12.076669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_emissions, now create_emissions_main)
[0m20:46:12.077933 [debug] [ThreadPool]: Creating schema "database: "emissions"
schema: "main"
"
[0m20:46:12.088425 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m20:46:12.089294 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='emissions'
        and type='sqlite'
    
  
[0m20:46:12.090168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:12.093287 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:46:12.096721 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m20:46:12.097535 [debug] [ThreadPool]: On create_emissions_main: BEGIN
[0m20:46:12.099837 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:46:12.100382 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m20:46:12.100890 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
    
        create schema if not exists "emissions"."main"
    
[0m20:46:12.102284 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:46:12.103698 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m20:46:12.104404 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m20:46:12.105087 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m20:46:12.106317 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:46:12.107058 [debug] [ThreadPool]: On create_emissions_main: Close
[0m20:46:12.109774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_emissions_main, now list_emissions_main)
[0m20:46:12.119821 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m20:46:12.120604 [debug] [ThreadPool]: On list_emissions_main: BEGIN
[0m20:46:12.121846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:12.123433 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:46:12.124060 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m20:46:12.124668 [debug] [ThreadPool]: On list_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions_main"} */
select
      'emissions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'emissions'
  
[0m20:46:12.138635 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:46:12.140449 [debug] [ThreadPool]: On list_emissions_main: ROLLBACK
[0m20:46:12.141288 [debug] [ThreadPool]: Failed to rollback 'list_emissions_main'
[0m20:46:12.141845 [debug] [ThreadPool]: On list_emissions_main: Close
[0m20:46:12.143880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a894b46d-fcb9-4067-ac3c-d062f031604d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc655e7d0>]}
[0m20:46:12.144640 [debug] [MainThread]: Using duckdb connection "master"
[0m20:46:12.145165 [debug] [MainThread]: On master: BEGIN
[0m20:46:12.145620 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:46:12.146731 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:46:12.147241 [debug] [MainThread]: On master: COMMIT
[0m20:46:12.147754 [debug] [MainThread]: Using duckdb connection "master"
[0m20:46:12.148294 [debug] [MainThread]: On master: COMMIT
[0m20:46:12.149502 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:46:12.150011 [debug] [MainThread]: On master: Close
[0m20:46:12.155184 [debug] [Thread-1 (]: Began running node model.taxi_co2.transform
[0m20:46:12.156156 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform .................................... [RUN]
[0m20:46:12.157025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_emissions_main, now model.taxi_co2.transform)
[0m20:46:12.157730 [debug] [Thread-1 (]: Began compiling node model.taxi_co2.transform
[0m20:46:12.174602 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_co2.transform"
[0m20:46:12.175725 [debug] [Thread-1 (]: Began executing node model.taxi_co2.transform
[0m20:46:12.254004 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_co2.transform"
[0m20:46:12.257784 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m20:46:12.258632 [debug] [Thread-1 (]: On model.taxi_co2.transform: BEGIN
[0m20:46:12.259275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:12.262631 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:46:12.263429 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m20:46:12.264098 [debug] [Thread-1 (]: On model.taxi_co2.transform: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

  
    
    

    create  table
      "emissions"."main"."transform__dbt_tmp"
  
    as (
      -- yellow taxi transformations
-- add CO2_PER_TRIP_KGS column
SELECT yellow_taxi.*,
    (
        yellow_taxi.trip_distance * (
            SELECT co2_grams_per_mile
            FROM vehicle_emissions
            WHERE vehicle_type = 'yellow_taxi'
        )
    ) / 1000 AS CO2_PER_TRIP_KGS,
    DATEDIFF(
        'second',
        tpep_pickup_datetime,
        tpep_dropoff_datetime
    ) / 3600 AS trip_hours
FROM yellow_taxi
    );
  
  
[0m20:48:28.236805 [debug] [Thread-1 (]: SQL status: OK in 135.879 seconds
[0m20:48:28.737667 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m20:48:28.742554 [debug] [Thread-1 (]: On model.taxi_co2.transform: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'transform'
  
[0m20:48:28.778267 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m20:48:28.794877 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m20:48:28.795948 [debug] [Thread-1 (]: On model.taxi_co2.transform: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'transform'
  
[0m20:48:28.803269 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:48:29.144464 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m20:48:29.145704 [debug] [Thread-1 (]: On model.taxi_co2.transform: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */
alter table "emissions"."main"."transform" rename to "transform__dbt_backup"
[0m20:48:29.151022 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:48:29.159329 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m20:48:29.160273 [debug] [Thread-1 (]: On model.taxi_co2.transform: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */
alter table "emissions"."main"."transform__dbt_tmp" rename to "transform"
[0m20:48:29.163988 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:48:29.234755 [debug] [Thread-1 (]: On model.taxi_co2.transform: COMMIT
[0m20:48:29.236117 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m20:48:29.236998 [debug] [Thread-1 (]: On model.taxi_co2.transform: COMMIT
[0m20:48:33.488516 [debug] [Thread-1 (]: SQL status: OK in 4.250 seconds
[0m20:48:33.511760 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m20:48:33.512664 [debug] [Thread-1 (]: On model.taxi_co2.transform: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

      drop table if exists "emissions"."main"."transform__dbt_backup" cascade
    
[0m20:48:33.626125 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m20:48:33.756613 [debug] [Thread-1 (]: On model.taxi_co2.transform: Close
[0m20:48:33.906523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a894b46d-fcb9-4067-ac3c-d062f031604d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d10c66d10>]}
[0m20:48:33.945780 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.transform ............................... [[32mOK[0m in 141.67s]
[0m20:48:33.956512 [debug] [Thread-1 (]: Finished running node model.taxi_co2.transform
[0m20:48:34.028044 [debug] [MainThread]: Using duckdb connection "master"
[0m20:48:34.031017 [debug] [MainThread]: On master: BEGIN
[0m20:48:34.033966 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:48:34.056648 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m20:48:34.057594 [debug] [MainThread]: On master: COMMIT
[0m20:48:34.058313 [debug] [MainThread]: Using duckdb connection "master"
[0m20:48:34.058910 [debug] [MainThread]: On master: COMMIT
[0m20:48:34.060336 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:48:34.061073 [debug] [MainThread]: On master: Close
[0m20:48:34.064218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:48:34.064903 [debug] [MainThread]: Connection 'model.taxi_co2.transform' was properly closed.
[0m20:48:34.070462 [info ] [MainThread]: 
[0m20:48:34.075148 [info ] [MainThread]: Finished running 1 table model in 0 hours 2 minutes and 22.10 seconds (142.10s).
[0m20:48:34.090334 [debug] [MainThread]: Command end result
[0m20:48:34.391559 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m20:48:34.633356 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m20:48:34.769655 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/ethancao/ds3022-data-project-1/dbt/target/run_results.json
[0m20:48:34.770732 [info ] [MainThread]: 
[0m20:48:34.780702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:48:34.782300 [info ] [MainThread]: 
[0m20:48:34.787880 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:48:34.856583 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 144.46417, "process_in_blocks": "22302824", "process_kernel_time": 717.7366, "process_mem_max_rss": "13836052", "process_out_blocks": "38114944", "process_user_time": 1001.99084}
[0m20:48:34.880696 [debug] [MainThread]: Command `dbt run` succeeded at 20:48:34.878756 after 144.49 seconds
[0m20:48:34.898009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1142dab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d046fd630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d0c8edb40>]}
[0m20:48:34.900476 [debug] [MainThread]: Flushing usage events
[0m20:48:35.600758 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:57:02.491745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2c404da80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2c3009270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2c3009210>]}


============================== 20:57:02.495929 | ef06bafa-3603-4701-9702-0b753e52a49d ==============================
[0m20:57:02.495929 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:57:02.496776 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'profiles_dir': '/home/ethancao/ds3022-data-project-1/dbt', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_format': 'default', 'no_print': 'None', 'empty': 'False', 'target_path': 'None', 'invocation_command': 'dbt run', 'log_path': '/home/ethancao/ds3022-data-project-1/dbt/logs', 'write_json': 'True', 'version_check': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'introspect': 'True', 'quiet': 'False', 'debug': 'False'}
[0m20:57:02.833115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef06bafa-3603-4701-9702-0b753e52a49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2c57f0af0>]}
[0m20:57:02.911336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef06bafa-3603-4701-9702-0b753e52a49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2c382aec0>]}
[0m20:57:02.915002 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m20:57:02.980728 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:57:03.125840 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:57:03.126653 [debug] [MainThread]: Partial parsing: updated file: taxi_co2://models/staging/transform.sql
[0m20:57:03.672235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef06bafa-3603-4701-9702-0b753e52a49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2c2ea1d80>]}
[0m20:57:03.753059 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m20:57:03.754608 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m20:57:03.779057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef06bafa-3603-4701-9702-0b753e52a49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2c321b880>]}
[0m20:57:03.780119 [info ] [MainThread]: Found 1 model, 3 sources, 431 macros
[0m20:57:03.780844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef06bafa-3603-4701-9702-0b753e52a49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2c3de2830>]}
[0m20:57:03.783480 [info ] [MainThread]: 
[0m20:57:03.784221 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:57:03.784804 [info ] [MainThread]: 
[0m20:57:03.785644 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:57:03.787390 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_emissions'
[0m20:57:03.848942 [debug] [ThreadPool]: Using duckdb connection "list_emissions"
[0m20:57:03.849781 [debug] [ThreadPool]: On list_emissions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"emissions"'
    
  
  
[0m20:57:03.850342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:03.893113 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m20:57:03.895048 [debug] [ThreadPool]: On list_emissions: Close
[0m20:57:03.896428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_emissions, now create_emissions_main)
[0m20:57:03.897101 [debug] [ThreadPool]: Creating schema "database: "emissions"
schema: "main"
"
[0m20:57:03.904481 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m20:57:03.904912 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='emissions'
        and type='sqlite'
    
  
[0m20:57:03.905235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:03.906509 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:57:03.907717 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m20:57:03.908087 [debug] [ThreadPool]: On create_emissions_main: BEGIN
[0m20:57:03.908836 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:57:03.909158 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m20:57:03.909441 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
    
        create schema if not exists "emissions"."main"
    
[0m20:57:03.910488 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:57:03.911366 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m20:57:03.911739 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m20:57:03.912077 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m20:57:03.912923 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:57:03.913324 [debug] [ThreadPool]: On create_emissions_main: Close
[0m20:57:03.914845 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_emissions_main, now list_emissions_main)
[0m20:57:03.920554 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m20:57:03.921096 [debug] [ThreadPool]: On list_emissions_main: BEGIN
[0m20:57:03.921465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:03.924775 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:57:03.925315 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m20:57:03.926008 [debug] [ThreadPool]: On list_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions_main"} */
select
      'emissions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'emissions'
  
[0m20:57:03.940292 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:57:03.941993 [debug] [ThreadPool]: On list_emissions_main: ROLLBACK
[0m20:57:03.943091 [debug] [ThreadPool]: Failed to rollback 'list_emissions_main'
[0m20:57:03.943567 [debug] [ThreadPool]: On list_emissions_main: Close
[0m20:57:03.945336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef06bafa-3603-4701-9702-0b753e52a49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2c3885030>]}
[0m20:57:03.945964 [debug] [MainThread]: Using duckdb connection "master"
[0m20:57:03.946344 [debug] [MainThread]: On master: BEGIN
[0m20:57:03.946680 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:57:03.947704 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:57:03.948166 [debug] [MainThread]: On master: COMMIT
[0m20:57:03.948596 [debug] [MainThread]: Using duckdb connection "master"
[0m20:57:03.948998 [debug] [MainThread]: On master: COMMIT
[0m20:57:03.949943 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:57:03.950514 [debug] [MainThread]: On master: Close
[0m20:57:03.957436 [debug] [Thread-1 (]: Began running node model.taxi_co2.transform
[0m20:57:03.958523 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform .................................... [RUN]
[0m20:57:03.959447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_emissions_main, now model.taxi_co2.transform)
[0m20:57:03.960127 [debug] [Thread-1 (]: Began compiling node model.taxi_co2.transform
[0m20:57:03.979006 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_co2.transform"
[0m20:57:03.980035 [debug] [Thread-1 (]: Began executing node model.taxi_co2.transform
[0m20:57:04.038748 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_co2.transform"
[0m20:57:04.040131 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m20:57:04.040860 [debug] [Thread-1 (]: On model.taxi_co2.transform: BEGIN
[0m20:57:04.041461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:04.042964 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:04.043623 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m20:57:04.044296 [debug] [Thread-1 (]: On model.taxi_co2.transform: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

  
    
    

    create  table
      "emissions"."main"."transform__dbt_tmp"
  
    as (
      -- yellow taxi transformations
-- add CO2_PER_TRIP_KGS column
SELECT yellow_taxi.*,
    (
        yellow_taxi.trip_distance * (
            SELECT co2_grams_per_mile
            FROM vehicle_emissions
            WHERE vehicle_type = 'yellow_taxi'
        )
    ) / 1000 AS co2_per_trip_kgs,
    DATEDIFF(
        'second',
        tpep_pickup_datetime,
        tpep_dropoff_datetime
    ) / 3600 AS trip_hours,
    CAST(strftime(tpep_pickup_datetime, '%u') AS INTEGER) AS trip_day_of_week,
    CAST(strftime(tpep_pickup_datetime, '%V') AS INTEGER) AS week_number,
    CAST(strftime(tpep_pickup_datetime, '%m') AS INTEGER) AS trip_month
FROM yellow_taxi
    );
  
  
[0m21:01:44.687275 [debug] [Thread-1 (]: SQL status: OK in 280.607 seconds
[0m21:01:44.766542 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m21:01:44.769263 [debug] [Thread-1 (]: On model.taxi_co2.transform: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'transform'
  
[0m21:01:44.833999 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m21:01:44.843342 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m21:01:44.845687 [debug] [Thread-1 (]: On model.taxi_co2.transform: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'transform'
  
[0m21:01:44.858587 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m21:01:44.971486 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m21:01:44.973581 [debug] [Thread-1 (]: On model.taxi_co2.transform: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */
alter table "emissions"."main"."transform" rename to "transform__dbt_backup"
[0m21:01:44.983428 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m21:01:44.997092 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m21:01:44.999451 [debug] [Thread-1 (]: On model.taxi_co2.transform: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */
alter table "emissions"."main"."transform__dbt_tmp" rename to "transform"
[0m21:01:45.007897 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:01:45.075277 [debug] [Thread-1 (]: On model.taxi_co2.transform: COMMIT
[0m21:01:45.077606 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m21:01:45.079818 [debug] [Thread-1 (]: On model.taxi_co2.transform: COMMIT
[0m21:01:49.873986 [debug] [Thread-1 (]: SQL status: OK in 4.790 seconds
[0m21:01:49.894730 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.transform"
[0m21:01:49.896225 [debug] [Thread-1 (]: On model.taxi_co2.transform: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.transform"} */

      drop table if exists "emissions"."main"."transform__dbt_backup" cascade
    
[0m21:01:50.099530 [debug] [Thread-1 (]: SQL status: OK in 0.202 seconds
[0m21:01:50.115336 [debug] [Thread-1 (]: On model.taxi_co2.transform: Close
[0m21:01:50.213565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef06bafa-3603-4701-9702-0b753e52a49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2c3885030>]}
[0m21:01:50.215689 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.transform ............................... [[32mOK[0m in 286.24s]
[0m21:01:50.217185 [debug] [Thread-1 (]: Finished running node model.taxi_co2.transform
[0m21:01:50.226394 [debug] [MainThread]: Using duckdb connection "master"
[0m21:01:50.227143 [debug] [MainThread]: On master: BEGIN
[0m21:01:50.228278 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:01:50.231895 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m21:01:50.232620 [debug] [MainThread]: On master: COMMIT
[0m21:01:50.233198 [debug] [MainThread]: Using duckdb connection "master"
[0m21:01:50.233737 [debug] [MainThread]: On master: COMMIT
[0m21:01:50.236733 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m21:01:50.237408 [debug] [MainThread]: On master: Close
[0m21:01:50.238324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:01:50.238798 [debug] [MainThread]: Connection 'model.taxi_co2.transform' was properly closed.
[0m21:01:50.240230 [info ] [MainThread]: 
[0m21:01:50.240947 [info ] [MainThread]: Finished running 1 table model in 0 hours 4 minutes and 46.45 seconds (286.45s).
[0m21:01:50.243257 [debug] [MainThread]: Command end result
[0m21:01:50.284639 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m21:01:50.292828 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m21:01:50.302389 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/ethancao/ds3022-data-project-1/dbt/target/run_results.json
[0m21:01:50.302936 [info ] [MainThread]: 
[0m21:01:50.303570 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:01:50.304068 [info ] [MainThread]: 
[0m21:01:50.304543 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:01:50.308924 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 287.87274, "process_in_blocks": "22071688", "process_kernel_time": 1006.9008, "process_mem_max_rss": "13687628", "process_out_blocks": "40672896", "process_user_time": 2783.0676}
[0m21:01:50.309660 [debug] [MainThread]: Command `dbt run` succeeded at 21:01:50.309497 after 287.87 seconds
[0m21:01:50.310325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2c404da80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2c3f2f040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2b6fb2b00>]}
[0m21:01:50.310876 [debug] [MainThread]: Flushing usage events
[0m21:01:50.460425 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:08:51.750922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b99cda20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b8975210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b89751b0>]}


============================== 21:08:51.756884 | 8dc2e7aa-ec73-4cda-9117-a60408b9b1ac ==============================
[0m21:08:51.756884 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:08:51.758079 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '/home/ethancao/ds3022-data-project-1/dbt', 'use_experimental_parser': 'False', 'log_path': '/home/ethancao/ds3022-data-project-1/dbt/logs', 'partial_parse': 'True', 'printer_width': '80', 'debug': 'False', 'target_path': 'None', 'log_format': 'default', 'version_check': 'True', 'no_print': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'fail_fast': 'False'}
[0m21:08:52.129696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dc2e7aa-ec73-4cda-9117-a60408b9b1ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15acdb6590>]}
[0m21:08:52.210965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8dc2e7aa-ec73-4cda-9117-a60408b9b1ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b891d390>]}
[0m21:08:52.215142 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m21:08:52.291980 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:08:52.428866 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m21:08:52.429558 [debug] [MainThread]: Partial parsing: added file: taxi_co2://models/staging/green_transformed.sql
[0m21:08:52.430018 [debug] [MainThread]: Partial parsing: added file: taxi_co2://models/staging/yellow_transformed.sql
[0m21:08:52.430357 [debug] [MainThread]: Partial parsing: deleted file: taxi_co2://models/staging/transform.sql
[0m21:08:52.824659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dc2e7aa-ec73-4cda-9117-a60408b9b1ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b88003d0>]}
[0m21:08:52.931031 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m21:08:52.932620 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m21:08:52.956987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dc2e7aa-ec73-4cda-9117-a60408b9b1ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b8865f60>]}
[0m21:08:52.958010 [info ] [MainThread]: Found 2 models, 3 sources, 431 macros
[0m21:08:52.958823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dc2e7aa-ec73-4cda-9117-a60408b9b1ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b8865270>]}
[0m21:08:52.961279 [info ] [MainThread]: 
[0m21:08:52.961921 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:08:52.962414 [info ] [MainThread]: 
[0m21:08:52.963148 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:08:52.974726 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_emissions'
[0m21:08:53.041285 [debug] [ThreadPool]: Using duckdb connection "list_emissions"
[0m21:08:53.042164 [debug] [ThreadPool]: On list_emissions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"emissions"'
    
  
  
[0m21:08:53.042783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:08:53.103294 [debug] [ThreadPool]: SQL status: OK in 0.060 seconds
[0m21:08:53.105778 [debug] [ThreadPool]: On list_emissions: Close
[0m21:08:53.107637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_emissions, now create_emissions_main)
[0m21:08:53.108734 [debug] [ThreadPool]: Creating schema "database: "emissions"
schema: "main"
"
[0m21:08:53.115538 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m21:08:53.116038 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='emissions'
        and type='sqlite'
    
  
[0m21:08:53.116384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:08:53.117923 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:08:53.119177 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m21:08:53.119553 [debug] [ThreadPool]: On create_emissions_main: BEGIN
[0m21:08:53.120320 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:08:53.120651 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m21:08:53.120935 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
    
        create schema if not exists "emissions"."main"
    
[0m21:08:53.121677 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:08:53.122573 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m21:08:53.122943 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m21:08:53.123300 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m21:08:53.123954 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:08:53.124347 [debug] [ThreadPool]: On create_emissions_main: Close
[0m21:08:53.125863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_emissions_main, now list_emissions_main)
[0m21:08:53.131083 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m21:08:53.131493 [debug] [ThreadPool]: On list_emissions_main: BEGIN
[0m21:08:53.131818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:08:53.133541 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:08:53.133890 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m21:08:53.134194 [debug] [ThreadPool]: On list_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions_main"} */
select
      'emissions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'emissions'
  
[0m21:08:53.147133 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m21:08:53.148809 [debug] [ThreadPool]: On list_emissions_main: ROLLBACK
[0m21:08:53.149970 [debug] [ThreadPool]: Failed to rollback 'list_emissions_main'
[0m21:08:53.150393 [debug] [ThreadPool]: On list_emissions_main: Close
[0m21:08:53.151959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dc2e7aa-ec73-4cda-9117-a60408b9b1ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15bb457640>]}
[0m21:08:53.152573 [debug] [MainThread]: Using duckdb connection "master"
[0m21:08:53.152984 [debug] [MainThread]: On master: BEGIN
[0m21:08:53.153436 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:08:53.155052 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:08:53.155896 [debug] [MainThread]: On master: COMMIT
[0m21:08:53.156612 [debug] [MainThread]: Using duckdb connection "master"
[0m21:08:53.156963 [debug] [MainThread]: On master: COMMIT
[0m21:08:53.157898 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:08:53.158337 [debug] [MainThread]: On master: Close
[0m21:08:53.164904 [debug] [Thread-1 (]: Began running node model.taxi_co2.green_transformed
[0m21:08:53.165613 [debug] [Thread-2 (]: Began running node model.taxi_co2.yellow_transformed
[0m21:08:53.166506 [info ] [Thread-1 (]: 1 of 2 START sql table model main.green_transformed ............................ [RUN]
[0m21:08:53.167511 [info ] [Thread-2 (]: 2 of 2 START sql table model main.yellow_transformed ........................... [RUN]
[0m21:08:53.168341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_emissions_main, now model.taxi_co2.green_transformed)
[0m21:08:53.169096 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.taxi_co2.yellow_transformed'
[0m21:08:53.169747 [debug] [Thread-1 (]: Began compiling node model.taxi_co2.green_transformed
[0m21:08:53.170387 [debug] [Thread-2 (]: Began compiling node model.taxi_co2.yellow_transformed
[0m21:08:53.178170 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_co2.green_transformed"
[0m21:08:53.180168 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_co2.yellow_transformed"
[0m21:08:53.181386 [debug] [Thread-1 (]: Began executing node model.taxi_co2.green_transformed
[0m21:08:53.192558 [debug] [Thread-2 (]: Began executing node model.taxi_co2.yellow_transformed
[0m21:08:53.247689 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_co2.green_transformed"
[0m21:08:53.248573 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_co2.yellow_transformed"
[0m21:08:53.250102 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.green_transformed"
[0m21:08:53.250732 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: BEGIN
[0m21:08:53.251285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:08:53.252746 [debug] [Thread-2 (]: Using duckdb connection "model.taxi_co2.yellow_transformed"
[0m21:08:53.253546 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: BEGIN
[0m21:08:53.254271 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:08:53.255121 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:08:53.255982 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.green_transformed"
[0m21:08:53.257497 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.green_transformed"} */

  
    
    

    create  table
      "emissions"."main"."green_transformed__dbt_tmp"
  
    as (
      -- green taxi transformations
SELECT green_taxi.*,
    (
        -- add column to calculate CO2 emissions per trip in kilograms
        green_taxi.trip_distance * (
            SELECT co2_grams_per_mile
            FROM vehicle_emissions
            WHERE vehicle_type = 'green_taxi'
        )
    ) / 1000 AS co2_per_trip_kgs,
    -- add column to calculate trip duration in hours
    DATEDIFF(
        'second',
        tpep_pickup_datetime,
        tpep_dropoff_datetime
    ) / 3600 AS trip_hours,
    -- add column to calculate the day of the week (1=Monday, 7=Sunday)
    CAST(strftime(tpep_pickup_datetime, '%u') AS INTEGER) AS trip_day_of_week,
    -- add column to extract week number of the year
    CAST(strftime(tpep_pickup_datetime, '%V') AS INTEGER) AS week_number,
    -- add column to extract month number of the year
    CAST(strftime(tpep_pickup_datetime, '%m') AS INTEGER) AS trip_month
FROM green_taxi
    );
  
  
[0m21:08:53.259089 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m21:08:53.259709 [debug] [Thread-2 (]: Using duckdb connection "model.taxi_co2.yellow_transformed"
[0m21:08:53.260305 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.yellow_transformed"} */

  
    
    

    create  table
      "emissions"."main"."yellow_transformed__dbt_tmp"
  
    as (
      -- yellow taxi transformations
SELECT yellow_taxi.*,
    (
        -- add column to calculate CO2 emissions per trip in kilograms
        yellow_taxi.trip_distance * (
            SELECT co2_grams_per_mile
            FROM vehicle_emissions
            WHERE vehicle_type = 'yellow_taxi'
        )
    ) / 1000 AS co2_per_trip_kgs,
    --- add column to calculate trip duration in hours
    DATEDIFF(
        'second',
        tpep_pickup_datetime,
        tpep_dropoff_datetime
    ) / 3600 AS trip_hours,
    --- add column to calculate the day of the week (1=Monday, 7=Sunday)
    CAST(strftime(tpep_pickup_datetime, '%u') AS INTEGER) AS trip_day_of_week,
    --- add column to extract week number of the year
    CAST(strftime(tpep_pickup_datetime, '%V') AS INTEGER) AS week_number,
    --- add column to extract month number of the year
    CAST(strftime(tpep_pickup_datetime, '%m') AS INTEGER) AS trip_month
FROM yellow_taxi
    );
  
  
[0m21:14:41.044662 [debug] [Thread-1 (]: SQL status: OK in 346.375 seconds
[0m21:14:52.513333 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.green_transformed"
[0m21:14:52.564618 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.green_transformed"} */
alter table "emissions"."main"."green_transformed__dbt_tmp" rename to "green_transformed"
[0m21:14:52.915940 [debug] [Thread-1 (]: SQL status: OK in 0.334 seconds
[0m21:14:53.595983 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: COMMIT
[0m21:14:53.615795 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.green_transformed"
[0m21:14:53.629252 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: COMMIT
[0m21:14:56.886585 [debug] [Thread-1 (]: SQL status: OK in 3.224 seconds
[0m21:14:57.169544 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.green_transformed"
[0m21:14:57.172910 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.green_transformed"} */

      drop table if exists "emissions"."main"."green_transformed__dbt_backup" cascade
    
[0m21:14:57.176502 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:14:59.499450 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: Close
[0m21:15:03.438223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dc2e7aa-ec73-4cda-9117-a60408b9b1ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15ac959c60>]}
[0m21:15:04.599536 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.green_transformed ....................... [[32mOK[0m in 368.05s]
[0m21:15:05.016343 [debug] [Thread-1 (]: Finished running node model.taxi_co2.green_transformed
[0m21:19:31.391288 [debug] [Thread-2 (]: SQL status: OK in 638.114 seconds
[0m21:19:31.419774 [debug] [Thread-2 (]: Using duckdb connection "model.taxi_co2.yellow_transformed"
[0m21:19:31.423283 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.yellow_transformed"} */
alter table "emissions"."main"."yellow_transformed__dbt_tmp" rename to "yellow_transformed"
[0m21:19:31.452656 [debug] [Thread-2 (]: SQL status: OK in 0.028 seconds
[0m21:19:31.459662 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: COMMIT
[0m21:19:31.460813 [debug] [Thread-2 (]: Using duckdb connection "model.taxi_co2.yellow_transformed"
[0m21:19:31.461855 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: COMMIT
[0m21:19:32.272806 [debug] [Thread-2 (]: SQL status: OK in 0.806 seconds
[0m21:19:32.281114 [debug] [Thread-2 (]: Using duckdb connection "model.taxi_co2.yellow_transformed"
[0m21:19:32.282520 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.yellow_transformed"} */

      drop table if exists "emissions"."main"."yellow_transformed__dbt_backup" cascade
    
[0m21:19:32.285948 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:19:32.294311 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: Close
[0m21:19:32.492808 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dc2e7aa-ec73-4cda-9117-a60408b9b1ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15acc2b040>]}
[0m21:19:32.497335 [info ] [Thread-2 (]: 2 of 2 OK created sql table model main.yellow_transformed ...................... [[32mOK[0m in 639.31s]
[0m21:19:32.498704 [debug] [Thread-2 (]: Finished running node model.taxi_co2.yellow_transformed
[0m21:19:32.557145 [debug] [MainThread]: Using duckdb connection "master"
[0m21:19:32.558634 [debug] [MainThread]: On master: BEGIN
[0m21:19:32.560676 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:19:32.574043 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m21:19:32.574849 [debug] [MainThread]: On master: COMMIT
[0m21:19:32.575543 [debug] [MainThread]: Using duckdb connection "master"
[0m21:19:32.576260 [debug] [MainThread]: On master: COMMIT
[0m21:19:32.578219 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:19:32.579099 [debug] [MainThread]: On master: Close
[0m21:19:32.635127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:32.637033 [debug] [MainThread]: Connection 'model.taxi_co2.green_transformed' was properly closed.
[0m21:19:32.637754 [debug] [MainThread]: Connection 'model.taxi_co2.yellow_transformed' was properly closed.
[0m21:19:32.651995 [info ] [MainThread]: 
[0m21:19:32.658259 [info ] [MainThread]: Finished running 2 table models in 0 hours 10 minutes and 39.68 seconds (639.68s).
[0m21:19:32.670324 [debug] [MainThread]: Command end result
[0m21:19:32.893615 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m21:19:33.104939 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m21:19:33.320546 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/ethancao/ds3022-data-project-1/dbt/target/run_results.json
[0m21:19:33.323237 [info ] [MainThread]: 
[0m21:19:33.330142 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:19:33.333987 [info ] [MainThread]: 
[0m21:19:33.345049 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m21:19:33.463557 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 641.77313, "process_in_blocks": "46032312", "process_kernel_time": 2254.9424, "process_mem_max_rss": "13796424", "process_out_blocks": "80308608", "process_user_time": 6203.472}
[0m21:19:33.486185 [debug] [MainThread]: Command `dbt run` succeeded at 21:19:33.483680 after 641.81 seconds
[0m21:19:33.517001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b99cda20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b98adcf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15acdb6ad0>]}
[0m21:19:33.522929 [debug] [MainThread]: Flushing usage events
[0m21:19:34.204171 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:33:54.307115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038d20d900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038c1b50f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038c1b5090>]}


============================== 21:33:54.312636 | a3eafd5a-c2ab-4fec-8b2f-65b201c1ab66 ==============================
[0m21:33:54.312636 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:33:54.313453 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'quiet': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'empty': 'False', 'profiles_dir': '/home/ethancao/ds3022-data-project-1/dbt', 'indirect_selection': 'eager', 'printer_width': '80', 'version_check': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'introspect': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'partial_parse': 'True', 'no_print': 'None', 'log_path': '/home/ethancao/ds3022-data-project-1/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m21:33:54.697002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3eafd5a-c2ab-4fec-8b2f-65b201c1ab66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03886cd390>]}
[0m21:33:54.777520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3eafd5a-c2ab-4fec-8b2f-65b201c1ab66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038c1b5cc0>]}
[0m21:33:54.781604 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m21:33:54.858308 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:33:55.044254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:33:55.045336 [debug] [MainThread]: Partial parsing: updated file: taxi_co2://models/staging/yellow_transformed.sql
[0m21:33:55.046028 [debug] [MainThread]: Partial parsing: updated file: taxi_co2://models/staging/green_transformed.sql
[0m21:33:55.442478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3eafd5a-c2ab-4fec-8b2f-65b201c1ab66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038c047250>]}
[0m21:33:55.529264 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m21:33:55.531429 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m21:33:55.556294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3eafd5a-c2ab-4fec-8b2f-65b201c1ab66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0380272230>]}
[0m21:33:55.556890 [info ] [MainThread]: Found 2 models, 3 sources, 431 macros
[0m21:33:55.557327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3eafd5a-c2ab-4fec-8b2f-65b201c1ab66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0380272200>]}
[0m21:33:55.558801 [info ] [MainThread]: 
[0m21:33:55.559233 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:33:55.559931 [info ] [MainThread]: 
[0m21:33:55.560576 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:33:55.566863 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_emissions'
[0m21:33:55.654813 [debug] [ThreadPool]: Using duckdb connection "list_emissions"
[0m21:33:55.655394 [debug] [ThreadPool]: On list_emissions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"emissions"'
    
  
  
[0m21:33:55.655826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:55.706888 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m21:33:55.709112 [debug] [ThreadPool]: On list_emissions: Close
[0m21:33:55.710433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_emissions, now create_emissions_main)
[0m21:33:55.711111 [debug] [ThreadPool]: Creating schema "database: "emissions"
schema: "main"
"
[0m21:33:55.719611 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m21:33:55.720122 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='emissions'
        and type='sqlite'
    
  
[0m21:33:55.720473 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:55.722012 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:33:55.723383 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m21:33:55.723812 [debug] [ThreadPool]: On create_emissions_main: BEGIN
[0m21:33:55.724761 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:33:55.725141 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m21:33:55.725442 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
    
        create schema if not exists "emissions"."main"
    
[0m21:33:55.726448 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:33:55.727616 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m21:33:55.727995 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m21:33:55.728324 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m21:33:55.728956 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:33:55.729322 [debug] [ThreadPool]: On create_emissions_main: Close
[0m21:33:55.730734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_emissions_main, now list_emissions_main)
[0m21:33:55.736031 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m21:33:55.736463 [debug] [ThreadPool]: On list_emissions_main: BEGIN
[0m21:33:55.736791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:55.738081 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:33:55.738531 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m21:33:55.738964 [debug] [ThreadPool]: On list_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions_main"} */
select
      'emissions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'emissions'
  
[0m21:33:55.750625 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m21:33:55.751948 [debug] [ThreadPool]: On list_emissions_main: ROLLBACK
[0m21:33:55.753508 [debug] [ThreadPool]: Failed to rollback 'list_emissions_main'
[0m21:33:55.753902 [debug] [ThreadPool]: On list_emissions_main: Close
[0m21:33:55.755685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3eafd5a-c2ab-4fec-8b2f-65b201c1ab66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03886cd690>]}
[0m21:33:55.756199 [debug] [MainThread]: Using duckdb connection "master"
[0m21:33:55.756535 [debug] [MainThread]: On master: BEGIN
[0m21:33:55.756827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:33:55.757630 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:33:55.757998 [debug] [MainThread]: On master: COMMIT
[0m21:33:55.758324 [debug] [MainThread]: Using duckdb connection "master"
[0m21:33:55.758618 [debug] [MainThread]: On master: COMMIT
[0m21:33:55.759278 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:33:55.759614 [debug] [MainThread]: On master: Close
[0m21:33:55.766138 [debug] [Thread-1 (]: Began running node model.taxi_co2.green_transformed
[0m21:33:55.766686 [debug] [Thread-2 (]: Began running node model.taxi_co2.yellow_transformed
[0m21:33:55.767497 [info ] [Thread-1 (]: 1 of 2 START sql table model main.green_transformed ............................ [RUN]
[0m21:33:55.768309 [info ] [Thread-2 (]: 2 of 2 START sql table model main.yellow_transformed ........................... [RUN]
[0m21:33:55.769086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_emissions_main, now model.taxi_co2.green_transformed)
[0m21:33:55.769906 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.taxi_co2.yellow_transformed'
[0m21:33:55.770723 [debug] [Thread-1 (]: Began compiling node model.taxi_co2.green_transformed
[0m21:33:55.771332 [debug] [Thread-2 (]: Began compiling node model.taxi_co2.yellow_transformed
[0m21:33:55.780498 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_co2.green_transformed"
[0m21:33:55.783380 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_co2.yellow_transformed"
[0m21:33:55.784613 [debug] [Thread-2 (]: Began executing node model.taxi_co2.yellow_transformed
[0m21:33:55.790678 [debug] [Thread-1 (]: Began executing node model.taxi_co2.green_transformed
[0m21:33:55.846759 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_co2.yellow_transformed"
[0m21:33:55.849967 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_co2.green_transformed"
[0m21:33:55.851788 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.green_transformed"
[0m21:33:55.852444 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: BEGIN
[0m21:33:55.853243 [debug] [Thread-2 (]: Using duckdb connection "model.taxi_co2.yellow_transformed"
[0m21:33:55.854102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:55.855017 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: BEGIN
[0m21:33:55.856293 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:33:55.858782 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:33:55.859430 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.green_transformed"
[0m21:33:55.860026 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.green_transformed"} */

  
    
    

    create  table
      "emissions"."main"."green_transformed__dbt_tmp"
  
    as (
      -- green taxi transformations
SELECT green_taxi.*,
    (
        -- add column to calculate CO2 emissions per trip in kilograms
        green_taxi.trip_distance * (
            SELECT co2_grams_per_mile
            FROM vehicle_emissions
            WHERE vehicle_type = 'green_taxi'
        )
    ) / 1000 AS trip_co2_kgs,
    -- add column to calculate average speed in miles per hour
    trip_distance / (
        date_diff(
            'second',
            tpep_pickup_datetime,
            tpep_dropoff_datetime
        ) / 3600.0
    ) AS avg_mph,
    -- add column to calculate hour of the day
    CAST(strftime(tpep_pickup_datetime, '%H') AS INTEGER) AS hour_of_day,
    -- add column to calculate the day of the week (1=Monday, 7=Sunday)
    CAST(strftime(tpep_pickup_datetime, '%u') AS INTEGER) AS day_of_week,
    -- add column to extract week number of the year
    CAST(strftime(tpep_pickup_datetime, '%V') AS INTEGER) AS week_of_year,
    -- add column to extract month number of the year
    CAST(strftime(tpep_pickup_datetime, '%m') AS INTEGER) AS month_of_year
FROM green_taxi
    );
  
  
[0m21:33:55.862015 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m21:33:55.862717 [debug] [Thread-2 (]: Using duckdb connection "model.taxi_co2.yellow_transformed"
[0m21:33:55.863383 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.yellow_transformed"} */

  
    
    

    create  table
      "emissions"."main"."yellow_transformed__dbt_tmp"
  
    as (
      -- yellow taxi transformations
SELECT yellow_taxi.*,
    (
        -- add column to calculate CO2 emissions per trip in kilograms
        yellow_taxi.trip_distance * (
            SELECT co2_grams_per_mile
            FROM vehicle_emissions
            WHERE vehicle_type = 'yellow_taxi'
        )
    ) / 1000 AS trip_co2_kgs,
    -- add column to calculate average speed in miles per hour
    trip_distance / (
        date_diff(
            'second',
            tpep_pickup_datetime,
            tpep_dropoff_datetime
        ) / 3600.0
    ) AS avg_mph,
    -- add column to calculate hour of the day
    CAST(strftime(tpep_pickup_datetime, '%H') AS INTEGER) AS hour_of_day,
    -- add column to calculate the day of the week (1=Monday, 7=Sunday)
    CAST(strftime(tpep_pickup_datetime, '%u') AS INTEGER) AS day_of_week,
    -- add column to extract week number of the year
    CAST(strftime(tpep_pickup_datetime, '%V') AS INTEGER) AS week_of_year,
    -- add column to extract month number of the year
    CAST(strftime(tpep_pickup_datetime, '%m') AS INTEGER) AS month_of_year
FROM yellow_taxi
    );
  
  
[0m21:39:56.220795 [debug] [Thread-2 (]: SQL status: OK in 359.258 seconds
[0m21:39:58.713527 [debug] [Thread-2 (]: Using duckdb connection "model.taxi_co2.yellow_transformed"
[0m21:39:58.734700 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.yellow_transformed"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'yellow_transformed'
  
[0m21:39:59.132066 [debug] [Thread-2 (]: SQL status: OK in 0.391 seconds
[0m21:39:59.211421 [debug] [Thread-2 (]: Using duckdb connection "model.taxi_co2.yellow_transformed"
[0m21:39:59.215139 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.yellow_transformed"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'yellow_transformed'
  
[0m21:39:59.260373 [debug] [Thread-2 (]: SQL status: OK in 0.031 seconds
[0m21:40:00.735098 [debug] [Thread-2 (]: Using duckdb connection "model.taxi_co2.yellow_transformed"
[0m21:40:00.754787 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.yellow_transformed"} */
alter table "emissions"."main"."yellow_transformed" rename to "yellow_transformed__dbt_backup"
[0m21:40:00.837683 [debug] [Thread-2 (]: SQL status: OK in 0.050 seconds
[0m21:40:00.984535 [debug] [Thread-2 (]: Using duckdb connection "model.taxi_co2.yellow_transformed"
[0m21:40:00.987134 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.yellow_transformed"} */
alter table "emissions"."main"."yellow_transformed__dbt_tmp" rename to "yellow_transformed"
[0m21:40:00.991479 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:40:01.444506 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: COMMIT
[0m21:40:01.493347 [debug] [Thread-2 (]: Using duckdb connection "model.taxi_co2.yellow_transformed"
[0m21:40:01.495110 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: COMMIT
[0m21:40:06.072479 [debug] [Thread-2 (]: SQL status: OK in 4.568 seconds
[0m21:40:06.229904 [debug] [Thread-2 (]: Using duckdb connection "model.taxi_co2.yellow_transformed"
[0m21:40:06.286802 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.yellow_transformed"} */

      drop table if exists "emissions"."main"."yellow_transformed__dbt_backup" cascade
    
[0m21:40:27.663382 [debug] [Thread-2 (]: SQL status: OK in 21.373 seconds
[0m21:40:28.270921 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: Close
[0m21:40:29.642066 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3eafd5a-c2ab-4fec-8b2f-65b201c1ab66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0380270790>]}
[0m21:40:29.750973 [info ] [Thread-2 (]: 2 of 2 OK created sql table model main.yellow_transformed ...................... [[32mOK[0m in 393.19s]
[0m21:40:29.777826 [debug] [Thread-2 (]: Finished running node model.taxi_co2.yellow_transformed
[0m21:47:30.474615 [debug] [Thread-1 (]: SQL status: OK in 814.551 seconds
[0m21:47:30.543895 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.green_transformed"
[0m21:47:30.547451 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.green_transformed"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'green_transformed'
  
[0m21:47:30.614564 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m21:47:30.626449 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.green_transformed"
[0m21:47:30.629281 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.green_transformed"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'green_transformed'
  
[0m21:47:30.654257 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m21:47:30.753998 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.green_transformed"
[0m21:47:30.757707 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.green_transformed"} */
alter table "emissions"."main"."green_transformed" rename to "green_transformed__dbt_backup"
[0m21:47:30.767985 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m21:47:30.813777 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.green_transformed"
[0m21:47:30.816113 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.green_transformed"} */
alter table "emissions"."main"."green_transformed__dbt_tmp" rename to "green_transformed"
[0m21:47:30.820654 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:47:30.834735 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: COMMIT
[0m21:47:30.837501 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.green_transformed"
[0m21:47:30.839109 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: COMMIT
[0m21:47:33.400349 [debug] [Thread-1 (]: SQL status: OK in 2.544 seconds
[0m21:47:33.417319 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.green_transformed"
[0m21:47:33.419991 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.green_transformed"} */

      drop table if exists "emissions"."main"."green_transformed__dbt_backup" cascade
    
[0m21:47:47.101410 [debug] [Thread-1 (]: SQL status: OK in 13.602 seconds
[0m21:47:47.116343 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: Close
[0m21:47:47.308712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3eafd5a-c2ab-4fec-8b2f-65b201c1ab66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03034ac820>]}
[0m21:47:47.334721 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.green_transformed ....................... [[32mOK[0m in 831.51s]
[0m21:47:47.339893 [debug] [Thread-1 (]: Finished running node model.taxi_co2.green_transformed
[0m21:47:47.461248 [debug] [MainThread]: Using duckdb connection "master"
[0m21:47:47.467905 [debug] [MainThread]: On master: BEGIN
[0m21:47:47.469822 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:47:47.515260 [debug] [MainThread]: SQL status: OK in 0.043 seconds
[0m21:47:47.516983 [debug] [MainThread]: On master: COMMIT
[0m21:47:47.518368 [debug] [MainThread]: Using duckdb connection "master"
[0m21:47:47.519566 [debug] [MainThread]: On master: COMMIT
[0m21:47:47.526205 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m21:47:47.527759 [debug] [MainThread]: On master: Close
[0m21:47:47.578730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:47:47.579967 [debug] [MainThread]: Connection 'model.taxi_co2.green_transformed' was properly closed.
[0m21:47:47.580805 [debug] [MainThread]: Connection 'model.taxi_co2.yellow_transformed' was properly closed.
[0m21:47:47.596511 [info ] [MainThread]: 
[0m21:47:47.600334 [info ] [MainThread]: Finished running 2 table models in 0 hours 13 minutes and 52.02 seconds (832.02s).
[0m21:47:47.612852 [debug] [MainThread]: Command end result
[0m21:47:47.901195 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m21:47:48.133371 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m21:47:48.288775 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/ethancao/ds3022-data-project-1/dbt/target/run_results.json
[0m21:47:48.293035 [info ] [MainThread]: 
[0m21:47:48.299190 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:47:48.304302 [info ] [MainThread]: 
[0m21:47:48.311864 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m21:47:48.410859 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 834.1642, "process_in_blocks": "46744072", "process_kernel_time": 2636.6592, "process_mem_max_rss": "13677376", "process_out_blocks": "82395368", "process_user_time": 7735.252}
[0m21:47:48.444894 [debug] [MainThread]: Command `dbt run` succeeded at 21:47:48.443422 after 834.21 seconds
[0m21:47:48.477506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038d20d900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038029ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f038d0ea4d0>]}
[0m21:47:48.484557 [debug] [MainThread]: Flushing usage events
[0m21:47:49.336183 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:06:21.361913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f666bfe99c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f666afa51b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f666afa5150>]}


============================== 12:06:21.368811 | 1116b9df-602e-4152-b165-410f607b7fe9 ==============================
[0m12:06:21.368811 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:06:21.369830 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_path': '/home/ethancao/ds3022-data-project-1/dbt/logs', 'version_check': 'True', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'debug': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'printer_width': '80', 'partial_parse': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'use_colors': 'True', 'fail_fast': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'profiles_dir': '/home/ethancao/ds3022-data-project-1/dbt', 'empty': 'False'}
[0m12:06:21.782540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1116b9df-602e-4152-b165-410f607b7fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665f3e2530>]}
[0m12:06:21.912304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1116b9df-602e-4152-b165-410f607b7fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f666b7f3a60>]}
[0m12:06:21.936718 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m12:06:22.049497 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:06:22.310528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:06:22.313686 [debug] [MainThread]: Partial parsing: updated file: taxi_co2://models/staging/green_transformed.sql
[0m12:06:22.965351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1116b9df-602e-4152-b165-410f607b7fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f666b7f3340>]}
[0m12:06:23.078216 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m12:06:23.081446 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m12:06:23.108143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1116b9df-602e-4152-b165-410f607b7fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665f30b430>]}
[0m12:06:23.108813 [info ] [MainThread]: Found 2 models, 3 sources, 431 macros
[0m12:06:23.109318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1116b9df-602e-4152-b165-410f607b7fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665cf7ea10>]}
[0m12:06:23.111140 [info ] [MainThread]: 
[0m12:06:23.111615 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:06:23.111985 [info ] [MainThread]: 
[0m12:06:23.112540 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:06:23.117747 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_emissions'
[0m12:06:23.179478 [debug] [ThreadPool]: Using duckdb connection "list_emissions"
[0m12:06:23.180196 [debug] [ThreadPool]: On list_emissions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"emissions"'
    
  
  
[0m12:06:23.180673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:23.296462 [debug] [ThreadPool]: SQL status: OK in 0.116 seconds
[0m12:06:23.298740 [debug] [ThreadPool]: On list_emissions: Close
[0m12:06:23.300457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_emissions, now create_emissions_main)
[0m12:06:23.301368 [debug] [ThreadPool]: Creating schema "database: "emissions"
schema: "main"
"
[0m12:06:23.312039 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m12:06:23.312918 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='emissions'
        and type='sqlite'
    
  
[0m12:06:23.313535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:06:23.315860 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:06:23.318061 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m12:06:23.318685 [debug] [ThreadPool]: On create_emissions_main: BEGIN
[0m12:06:23.320171 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:06:23.320782 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m12:06:23.321296 [debug] [ThreadPool]: On create_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "create_emissions_main"} */

    
    
        create schema if not exists "emissions"."main"
    
[0m12:06:23.322750 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:06:23.324190 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m12:06:23.325604 [debug] [ThreadPool]: Using duckdb connection "create_emissions_main"
[0m12:06:23.326282 [debug] [ThreadPool]: On create_emissions_main: COMMIT
[0m12:06:23.327735 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:06:23.328359 [debug] [ThreadPool]: On create_emissions_main: Close
[0m12:06:23.330723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_emissions_main, now list_emissions_main)
[0m12:06:23.339989 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m12:06:23.340776 [debug] [ThreadPool]: On list_emissions_main: BEGIN
[0m12:06:23.341353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:06:23.343112 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:06:23.343721 [debug] [ThreadPool]: Using duckdb connection "list_emissions_main"
[0m12:06:23.344249 [debug] [ThreadPool]: On list_emissions_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "connection_name": "list_emissions_main"} */
select
      'emissions' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'emissions'
  
[0m12:06:23.364511 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m12:06:23.367158 [debug] [ThreadPool]: On list_emissions_main: ROLLBACK
[0m12:06:23.369686 [debug] [ThreadPool]: Failed to rollback 'list_emissions_main'
[0m12:06:23.370411 [debug] [ThreadPool]: On list_emissions_main: Close
[0m12:06:23.373945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1116b9df-602e-4152-b165-410f607b7fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665d0972e0>]}
[0m12:06:23.374921 [debug] [MainThread]: Using duckdb connection "master"
[0m12:06:23.375581 [debug] [MainThread]: On master: BEGIN
[0m12:06:23.376146 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:06:23.377604 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:06:23.378269 [debug] [MainThread]: On master: COMMIT
[0m12:06:23.378845 [debug] [MainThread]: Using duckdb connection "master"
[0m12:06:23.379379 [debug] [MainThread]: On master: COMMIT
[0m12:06:23.380762 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:06:23.381511 [debug] [MainThread]: On master: Close
[0m12:06:23.391268 [debug] [Thread-1 (]: Began running node model.taxi_co2.green_transformed
[0m12:06:23.392242 [debug] [Thread-2 (]: Began running node model.taxi_co2.yellow_transformed
[0m12:06:23.393558 [info ] [Thread-1 (]: 1 of 2 START sql table model main.green_transformed ............................ [RUN]
[0m12:06:23.395822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_emissions_main, now model.taxi_co2.green_transformed)
[0m12:06:23.396706 [debug] [Thread-1 (]: Began compiling node model.taxi_co2.green_transformed
[0m12:06:23.394634 [info ] [Thread-2 (]: 2 of 2 START sql table model main.yellow_transformed ........................... [RUN]
[0m12:06:23.410431 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_co2.green_transformed"
[0m12:06:23.411853 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.taxi_co2.yellow_transformed'
[0m12:06:23.413991 [debug] [Thread-2 (]: Began compiling node model.taxi_co2.yellow_transformed
[0m12:06:23.418075 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_co2.yellow_transformed"
[0m12:06:23.419639 [debug] [Thread-1 (]: Began executing node model.taxi_co2.green_transformed
[0m12:06:23.445455 [debug] [Thread-2 (]: Began executing node model.taxi_co2.yellow_transformed
[0m12:06:23.510813 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_co2.green_transformed"
[0m12:06:23.515463 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_co2.yellow_transformed"
[0m12:06:23.518168 [debug] [Thread-2 (]: Using duckdb connection "model.taxi_co2.yellow_transformed"
[0m12:06:23.519570 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.green_transformed"
[0m12:06:23.520655 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: BEGIN
[0m12:06:23.521761 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: BEGIN
[0m12:06:23.522909 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:06:23.525045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:23.532900 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m12:06:23.533904 [debug] [Thread-2 (]: Using duckdb connection "model.taxi_co2.yellow_transformed"
[0m12:06:23.535859 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.yellow_transformed"} */

  
    
    

    create  table
      "emissions"."main"."yellow_transformed__dbt_tmp"
  
    as (
      -- yellow taxi transformations
SELECT yellow_taxi.*,
    (
        -- add column to calculate CO2 emissions per trip in kilograms
        yellow_taxi.trip_distance * (
            SELECT co2_grams_per_mile
            FROM vehicle_emissions
            WHERE vehicle_type = 'yellow_taxi'
        )
    ) / 1000 AS trip_co2_kgs,
    -- add column to calculate average speed in miles per hour
    trip_distance / (
        date_diff(
            'second',
            tpep_pickup_datetime,
            tpep_dropoff_datetime
        ) / 3600.0
    ) AS avg_mph,
    -- add column to calculate hour of the day
    CAST(strftime(tpep_pickup_datetime, '%H') AS INTEGER) AS hour_of_day,
    -- add column to calculate the day of the week (1=Monday, 7=Sunday)
    CAST(strftime(tpep_pickup_datetime, '%u') AS INTEGER) AS day_of_week,
    -- add column to extract week number of the year
    CAST(strftime(tpep_pickup_datetime, '%V') AS INTEGER) AS week_of_year,
    -- add column to extract month number of the year
    CAST(strftime(tpep_pickup_datetime, '%m') AS INTEGER) AS month_of_year
FROM yellow_taxi
    );
  
  
[0m12:06:23.539250 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m12:06:23.557548 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.green_transformed"
[0m12:06:23.558733 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.green_transformed"} */

  
    
    

    create  table
      "emissions"."main"."green_transformed__dbt_tmp"
  
    as (
      -- green taxi transformations
SELECT green_taxi.*,
    (
        -- add column to calculate CO2 emissions per trip in kilograms
        green_taxi.trip_distance * (
            SELECT co2_grams_per_mile
            FROM vehicle_emissions
            WHERE vehicle_type = 'green_taxi'
        )
    ) / 1000 AS trip_co2_kgs,
    -- add column to calculate average speed in miles per hour
    trip_distance / (
        date_diff(
            'second',
            lpep_pickup_datetime,
            lpep_dropoff_datetime
        ) / 3600.0
    ) AS avg_mph,
    -- add column to calculate hour of the day
    CAST(strftime(lpep_pickup_datetime, '%H') AS INTEGER) AS hour_of_day,
    -- add column to calculate the day of the week (1=Monday, 7=Sunday)
    CAST(strftime(lpep_pickup_datetime, '%u') AS INTEGER) AS day_of_week,
    -- add column to extract week number of the year
    CAST(strftime(lpep_pickup_datetime, '%V') AS INTEGER) AS week_of_year,
    -- add column to extract month number of the year
    CAST(strftime(lpep_pickup_datetime, '%m') AS INTEGER) AS month_of_year
FROM green_taxi
    );
  
  
[0m12:11:00.752647 [debug] [Thread-2 (]: SQL status: OK in 275.774 seconds
[0m12:11:03.678812 [debug] [Thread-1 (]: SQL status: OK in 280.098 seconds
[0m12:11:03.937163 [debug] [Thread-2 (]: Using duckdb connection "model.taxi_co2.yellow_transformed"
[0m12:11:03.935177 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.green_transformed"
[0m12:11:03.940601 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.yellow_transformed"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'yellow_transformed'
  
[0m12:11:03.943210 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.green_transformed"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'green_transformed'
  
[0m12:11:04.000481 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m12:11:04.001672 [debug] [Thread-2 (]: SQL status: OK in 0.057 seconds
[0m12:11:04.039911 [debug] [Thread-2 (]: Using duckdb connection "model.taxi_co2.yellow_transformed"
[0m12:11:04.041325 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.green_transformed"
[0m12:11:04.043013 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.yellow_transformed"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'yellow_transformed'
  
[0m12:11:04.044132 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.green_transformed"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'green_transformed'
  
[0m12:11:04.051774 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m12:11:04.053234 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:11:04.374624 [debug] [Thread-2 (]: Using duckdb connection "model.taxi_co2.yellow_transformed"
[0m12:11:04.373713 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.green_transformed"
[0m12:11:04.376705 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.yellow_transformed"} */
alter table "emissions"."main"."yellow_transformed" rename to "yellow_transformed__dbt_backup"
[0m12:11:04.378508 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.green_transformed"} */
alter table "emissions"."main"."green_transformed" rename to "green_transformed__dbt_backup"
[0m12:11:04.386690 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:11:04.388793 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m12:11:04.400264 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.green_transformed"
[0m12:11:04.407912 [debug] [Thread-2 (]: Using duckdb connection "model.taxi_co2.yellow_transformed"
[0m12:11:04.408872 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.green_transformed"} */
alter table "emissions"."main"."green_transformed__dbt_tmp" rename to "green_transformed"
[0m12:11:04.410240 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.yellow_transformed"} */
alter table "emissions"."main"."yellow_transformed__dbt_tmp" rename to "yellow_transformed"
[0m12:11:04.413511 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:11:04.420331 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m12:11:04.521214 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: COMMIT
[0m12:11:04.519460 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: COMMIT
[0m12:11:04.525516 [debug] [Thread-2 (]: Using duckdb connection "model.taxi_co2.yellow_transformed"
[0m12:11:04.526721 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.green_transformed"
[0m12:11:04.527805 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: COMMIT
[0m12:11:04.528895 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: COMMIT
[0m12:11:05.240922 [debug] [Thread-2 (]: SQL status: OK in 0.709 seconds
[0m12:11:05.277033 [debug] [Thread-2 (]: Using duckdb connection "model.taxi_co2.yellow_transformed"
[0m12:11:05.281078 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.yellow_transformed"} */

      drop table if exists "emissions"."main"."yellow_transformed__dbt_backup" cascade
    
[0m12:11:05.361214 [debug] [Thread-1 (]: SQL status: OK in 0.826 seconds
[0m12:11:05.373788 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_co2.green_transformed"
[0m12:11:05.378473 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "taxi_co2", "target_name": "dev", "node_id": "model.taxi_co2.green_transformed"} */

      drop table if exists "emissions"."main"."green_transformed__dbt_backup" cascade
    
[0m12:11:06.538859 [debug] [Thread-2 (]: SQL status: OK in 1.238 seconds
[0m12:11:06.692735 [debug] [Thread-2 (]: On model.taxi_co2.yellow_transformed: Close
[0m12:11:06.956583 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1116b9df-602e-4152-b165-410f607b7fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f666d790b20>]}
[0m12:11:06.995342 [info ] [Thread-2 (]: 2 of 2 OK created sql table model main.yellow_transformed ...................... [[32mOK[0m in 283.45s]
[0m12:11:07.008264 [debug] [Thread-2 (]: Finished running node model.taxi_co2.yellow_transformed
[0m12:11:08.032276 [debug] [Thread-1 (]: SQL status: OK in 2.635 seconds
[0m12:11:08.037637 [debug] [Thread-1 (]: On model.taxi_co2.green_transformed: Close
[0m12:11:08.106482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1116b9df-602e-4152-b165-410f607b7fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665d0972e0>]}
[0m12:11:08.108612 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.green_transformed ....................... [[32mOK[0m in 284.71s]
[0m12:11:08.110424 [debug] [Thread-1 (]: Finished running node model.taxi_co2.green_transformed
[0m12:11:08.168271 [debug] [MainThread]: Using duckdb connection "master"
[0m12:11:08.170157 [debug] [MainThread]: On master: BEGIN
[0m12:11:08.172646 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:11:08.194582 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m12:11:08.195892 [debug] [MainThread]: On master: COMMIT
[0m12:11:08.197140 [debug] [MainThread]: Using duckdb connection "master"
[0m12:11:08.198075 [debug] [MainThread]: On master: COMMIT
[0m12:11:08.203285 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m12:11:08.204071 [debug] [MainThread]: On master: Close
[0m12:11:08.236202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:08.237497 [debug] [MainThread]: Connection 'model.taxi_co2.green_transformed' was properly closed.
[0m12:11:08.238448 [debug] [MainThread]: Connection 'model.taxi_co2.yellow_transformed' was properly closed.
[0m12:11:08.245532 [info ] [MainThread]: 
[0m12:11:08.249665 [info ] [MainThread]: Finished running 2 table models in 0 hours 4 minutes and 45.13 seconds (285.13s).
[0m12:11:08.260224 [debug] [MainThread]: Command end result
[0m12:11:08.414712 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ethancao/ds3022-data-project-1/dbt/target/manifest.json
[0m12:11:08.508257 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ethancao/ds3022-data-project-1/dbt/target/semantic_manifest.json
[0m12:11:08.585148 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/ethancao/ds3022-data-project-1/dbt/target/run_results.json
[0m12:11:08.586287 [info ] [MainThread]: 
[0m12:11:08.589104 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:11:08.590193 [info ] [MainThread]: 
[0m12:11:08.593489 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:11:08.645296 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 287.3752, "process_in_blocks": "18000584", "process_kernel_time": 789.64484, "process_mem_max_rss": "13442668", "process_out_blocks": "38748856", "process_user_time": 3238.322}
[0m12:11:08.658790 [debug] [MainThread]: Command `dbt run` succeeded at 12:11:08.657619 after 287.39 seconds
[0m12:11:08.671379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f666bfe99c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f666becb790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665f3e0220>]}
[0m12:11:08.674211 [debug] [MainThread]: Flushing usage events
[0m12:11:09.212915 [debug] [MainThread]: An error was encountered while trying to flush usage events
